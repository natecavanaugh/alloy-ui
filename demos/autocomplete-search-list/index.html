<!DOCTYPE html>

<html>
<head>
	<script src="../../build/aui/aui.js" type="text/javascript"></script>

	<link rel="stylesheet" href="../../build/aui-skin-classic/css/aui-skin-classic-all-min.css" type="text/css" media="screen" />

	<style type="text/css" media="screen">
	
		body {
			font-size: 12px;
			margin: 10px;
		}

		#wrapper {
			padding: 10px;
		}

		#tags-selected {
			width: 400px;
			height: 20px;
			border-radius: 0px 0px 0px 0px;
		}

	</style>

</head>

<body class ="yui3-skin-sam">

	<div id="wrapper">
		<h1>Alloy - AutocompleteSearchList - Tags Selector Demo</h1>

		<div id="tags-div" style="width: 719px;">
			<input id="tags-selected" class="aui-field-input aui-field-input-text" type="text"/> <br />
		</div>
		<p />
		<div id="demo"> </div>
	</div>

	<script type="text/javascript" charset="utf-8">

	AUI().ready('aui-template', 'aui-autocomplete-search-list', 'autocomplete-base', 'aui-aria', 'aui-dialog', 'aui-overlay-manager', 'dd-constrain', function(A) {

		var CSS_NO_MATCHES = 'no-matches';
		var NO_RESULTS_MESSAGE = 'No results found.'
		var STR_BLANK = '';
		var TPL_FIELD = '<span class="myTestClass aui-field aui-field-choice aui-field-checkbox aui-field-checked">';
		var TPL_FIELD_CONTENT = '<span class="aui-field-content">';
		var TPL_FIELDSET = '<fieldset class="{[ !values.results || !values.results.length ? "no-matches" : "" ]}" >';
		var TPL_FOR_RESULTS = '<tpl for="results">';
		var TPL_LABEL_INPUT = '<label title="{name}"><input class="aui-field-input aui-field-input-choice aui-field-input-checkbox" type="checkbox" value="{name}" {[values.checked ? "checked" : ""]} >{name}</label>';

		var template = new A.Template(
				'<fieldset class="{[(!values.results || !values.results.length) ? "', CSS_NO_MATCHES, '" : "', STR_BLANK ,'" ]}">',
					'<tpl for="results">',
						'<label title="{text}"><input {[values.checked ? "checked" : ""]} type="checkbox" value="{text}" />{text}</label>',
					'</tpl>',

					'<div class="no-matches-message">{[(!values.results || !values.results.length) ? "', NO_RESULTS_MESSAGE ,'" : ""]}</div>',
				'</fieldset>'
			);

		var toolItemConfig = {
			render: '#demo',
			activeState: null
		};

		var buttonItems = ['add', 'select', 'suggest'];

		var i = buttonItems.length;

		while(i--){
			toolItemConfig.label = buttonItems[i];
			toolItemConfig.title = buttonItems[i];
			toolItemConfig.id = buttonItems[i];

			new A.ButtonItem(toolItemConfig);
		}

		var testSource = [
			{
				assetCount: 0, checked: false, companyId: 1, createDate: 1330542975270, groupId: 19, modifiedDate: 1330542975270, text: "how to", tagId: 11834, userId: 2, userName: "Joe Bloggs"
			},

			{
				assetCount: 0, checked: false, companyId: 1, createDate: 1330542874231, groupId: 19, modifiedDate: 1330542874231, text: "owner_only", tagId: 11825, userId: 2, userName: "Joe Bloggs",
			},

			{
				assetCount: 0, checked: false, companyId: 1, createDate: 1330542938833, groupId: 19, modifiedDate: 1330542938833, text: "ui team", tagId: 11830, userId: 2, userName: "Joe Bloggs"
			}
		];

		var popup;

		A.one('#select').on('click', function() {
			if (!popup){
				popup = new A.Dialog({
					title: 'Autocomplete Search List',
					constrain2view: true,
					draggable: true,
					height: 300,
					width: 265,
					xy: [200, 50]
				});
				popup.plug(A.AutocompleteSearchList, {

					noResultsMessage: NO_RESULTS_MESSAGE,
					mode: 'demo',
					source: testSource,
					searchInitially: true,
					resultHighlighter: 'phraseMatch',
					// templateType: 'asset-tags-selector',
					template: template,
					inputSelector: '#tags-selected',
					resultTextLocator: 'text'

				});
				popup.render();
			}
			else
			{
				popup.show();
			}
		});

	});

	</script>



</body>
</html>