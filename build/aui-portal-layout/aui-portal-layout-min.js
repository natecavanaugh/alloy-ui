AUI.add("aui-portal-layout",function(u){var ap=u.Lang,W=ap.isBoolean,x=ap.isFunction,Z=ap.isObject,n=ap.isString,i=ap.isValue,M=Math.ceil,g=u.DD.DDM,t="append",am="circle",O="delegateConfig",N="down",E="drag",k="dragNode",l="dragNodes",z="dropContainer",s="dropNodes",ac="groups",S="icon",b="indicator",m="l",B="lazyStart",I="left",P="marginBottom",p="marginTop",al="node",aa="offsetHeight",ab="offsetWidth",v="placeholder",Y="placeAfter",o="placeBefore",an="portal-layout",w="prepend",ao="proxy",ae="proxyNode",h="r",K="region",ag="right",a=" ",Q="target",aj="triangle",C="up",q="placeholderAlign",T="quadrantEnter",r="quadrantExit",ai="quadrantOver",ak=0,X=0,y=0,f=0,D=function(A){return(A instanceof u.NodeList);},J=function(){return Array.prototype.slice.call(arguments).join(a);},c=function(A){return D(A)?A:u.all(A);},V=function(L,A){return parseInt(L.getStyle(A),10)||0;},j=u.getClassName,H=j(an,E,b),G=j(an,E,b,S),ad=j(an,E,b,S,I),e=j(an,E,b,S,ag),d=j(an,E,Q,b),af=j(S),aq=j(S,am,aj,m),ah=j(S,am,aj,h),F='<div class="'+H+'">'+'<div class="'+J(G,ad,af,ah)+'"></div>'+'<div class="'+J(G,e,af,aq)+'"></div>'+"<div>";var U=u.Component.create({NAME:an,ATTRS:{delegateConfig:{value:null,setter:function(R){var A=this;var L=u.merge({bubbleTargets:A,dragConfig:{},nodes:A.get(l),target:true},R);u.mix(L.dragConfig,{groups:A.get(ac),startCentered:true});return L;},validator:Z},proxyNode:{setter:function(A){return n(A)?u.Node.create(A):A;}},dragNodes:{validator:n},dropContainer:{value:function(A){return A;},validator:x},dropNodes:{setter:"_setDropNodes"},groups:{value:[an]},lazyStart:{value:false,validator:W},placeholder:{value:F,setter:function(L){var A=n(L)?u.Node.create(L):L;if(!A.inDoc()){u.getBody().prepend(A.hide());}ak=V(A,P);X=V(A,p);A.addClass(d);y=V(A,P);f=V(A,p);return A;}},proxy:{value:null,setter:function(R){var A=this;var L={moveOnEnd:false,positionProxy:false};if(A.get(ae)){L.borderStyle=null;}return u.merge(L,R||{});}}},EXTENDS:u.Base,prototype:{initializer:function(){var A=this;A.bindUI();},bindUI:function(){var A=this;A.publish(q,{defaultFn:A._defPlaceholderAlign,queuable:false,emitFacade:true,bubbles:true});A._bindDDEvents();A._bindDropZones();},addDropNode:function(R,L){var A=this;R=u.one(R);if(!g.getDrop(R)){A.addDropTarget(new u.DD.Drop(u.merge({bubbleTargets:A,groups:A.get(ac),node:R},L)));}},addDropTarget:function(L){var A=this;L.addToGroup(A.get(ac));},alignPlaceholder:function(R,L){var A=this;var ar=A.get(v);if(!A.lazyEvents){ar.show();}A._syncPlaceholderSize();ar.setXY(A.getPlaceholderXY(R,L));},calculateDirections:function(R){var L=this;var ar=L.lastY;var at=L.lastX;var A=R.lastXY[0];var au=R.lastXY[1];if(A!=at){L.XDirection=(A<at)?I:ag;}if(au!=ar){L.YDirection=(au<ar)?C:N;}L.lastX=A;L.lastY=au;},calculateQuadrant:function(ax,L){var aA=this;var au=1;var az=L.get(al).get(K);var aw=ax.mouseXY;var at=aw[0];var ar=aw[1];var ay=az.top;var R=az.left;var A=ay+(az.bottom-ay)/2;var av=R+(az.right-R)/2;if(ar<A){au=(at>av)?1:2;}else{au=(at<av)?3:4;}aA.quadrant=au;return au;},getPlaceholderXY:function(av,L){var az=this;var ay=az.get(v);var at=ak;var A=X;if(L){at=y;A=f;}ay.toggleClass(d,L);var ar=M(av.bottom);var R=M(av.left);var ax=M(av.top);var aw=R;var au=(az.quadrant<3)?(ax-(ay.get(aa)+at)):(ar+A);return[aw,au];},removeDropTarget:function(L){var A=this;L.removeFromGroup(A.get(ac));},_alignCondition:function(){var A=this;var at=g.activeDrag;var R=A.activeDrop;if(at&&R){var ar=at.get(al);var L=R.get(al);return !ar.contains(L);}return true;},_bindDDEvents:function(){var A=this;var L=A.get(O);var R=A.get(ao);A.delegate=new u.DD.Delegate(L);A.delegate.dd.plug(u.Plugin.DDProxy,R);A.on("drag:end",u.bind(A._onDragEnd,A));A.on("drag:enter",u.bind(A._onDragEnter,A));A.on("drag:exit",u.bind(A._onDragExit,A));A.on("drag:over",u.bind(A._onDragOver,A));A.on("drag:start",u.bind(A._onDragStart,A));A.after("drag:start",u.bind(A._afterDragStart,A));A.on(T,A._syncPlaceholderUI);A.on(r,A._syncPlaceholderUI);},_bindDropZones:function(){var A=this;var L=A.get(s);if(L){L.each(function(ar,R){A.addDropNode(ar);});}},_defPlaceholderAlign:function(at){var A=this;var R=A.activeDrop;var au=A.get(v);if(R&&au){var ar=R.get("node");var L=!!ar.drop;A.lastAlignDrop=R;A.alignPlaceholder(R.get(al).get(K),L);}},_evOutput:function(){var A=this;return{drag:g.activeDrag,drop:A.activeDrop,quadrant:A.quadrant,XDirection:A.XDirection,YDirection:A.YDirection};},_fireQuadrantEvents:function(){var A=this;var ar=A._evOutput();var R=A.lastQuadrant;var L=A.quadrant;if(L!=R){if(R){A.fire(r,u.merge({lastDrag:A.lastDrag,lastDrop:A.lastDrop,lastQuadrant:A.lastQuadrant,lastXDirection:A.lastXDirection,lastYDirection:A.lastYDirection},ar));}A.fire(T,ar);}A.fire(ai,ar);A.lastDrag=g.activeDrag;A.lastDrop=A.activeDrop;A.lastQuadrant=L;A.lastXDirection=A.XDirection;A.lastYDirection=A.YDirection;},_getAppendNode:function(){return g.activeDrag.get(al);},_positionNode:function(at){var A=this;var ar=A.lastAlignDrop||A.activeDrop;if(ar){var av=A._getAppendNode();var L=ar.get(al);var R=i(L.drop);var au=(A.quadrant<3);if(A._alignCondition()){if(R){L[au?o:Y](av);}else{var aw=A.get(z).apply(A,[L]);aw[au?w:t](av);}}}},_syncPlaceholderUI:function(L){var A=this;if(A._alignCondition()){A.fire(q,{drop:A.activeDrop,originalEvent:L});}},_syncPlaceholderSize:function(){var A=this;var L=A.activeDrop.get(al);var R=A.get(v);if(R){R.set(ab,L.get(ab));}},_syncProxyNodeUI:function(R){var A=this;var ar=g.activeDrag.get(k);var L=A.get(ae);if(L&&!L.compareTo(ar)){ar.append(L);A._syncProxyNodeSize();}},_syncProxyNodeSize:function(){var A=this;var R=g.activeDrag.get(al);var L=A.get(ae);if(R&&L){L.set(aa,R.get(aa));L.set(ab,R.get(ab));}},_afterDragStart:function(L){var A=this;if(A.get(ao)){A._syncProxyNodeUI(L);}},_onDragEnd:function(R){var A=this;var ar=A.get(v);var L=A.get(ae);if(!A.lazyEvents){A._positionNode(R);}if(L){L.remove();}if(ar){ar.hide();}A.lastQuadrant=null;A.lastXDirection=null;A.lastYDirection=null;},_onDragEnter:function(L){var A=this;A.activeDrop=g.activeDrop;if(A.lazyEvents&&A.lastActiveDrop){A.lazyEvents=false;
A._syncPlaceholderUI(L);}if(!A.lastActiveDrop){A.lastActiveDrop=g.activeDrop;}},_onDragExit:function(L){var A=this;A._syncPlaceholderUI(L);A.activeDrop=g.activeDrop;A.lastActiveDrop=g.activeDrop;},_onDragOver:function(R){var A=this;var L=R.drag;if(A.activeDrop==g.activeDrop){A.calculateDirections(L);A.calculateQuadrant(L,A.activeDrop);A._fireQuadrantEvents();}},_onDragStart:function(L){var A=this;if(A.get(B)){A.lazyEvents=true;}A.lastActiveDrop=null;A.activeDrop=g.activeDrop;},_setDropNodes:function(L){var A=this;if(x(L)){L=L.call(A);}return c(L);}}});u.PortalLayout=U;},"@VERSION@",{requires:["aui-base","dd-drag","dd-delegate","dd-drop","dd-proxy"],skinnable:true});