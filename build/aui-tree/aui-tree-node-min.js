AUI.add("aui-tree-node",function(af){var U=af.Lang,aP=U.isString,aF=U.isBoolean,aY="alwaysShowHitArea",Q="",s="boundingBox",g="children",aL="clearfix",x="collapsed",a="container",ad="content",v="contentBox",j="expanded",p="helper",X="hidden",f="hitAreaEl",J="hitarea",V="icon",aX="iconEl",av="id",al="label",Y="labelEl",T="lastSelected",aK="leaf",q="node",an="over",aa="ownerTree",e="parentNode",aB="radio",aV="rendered",aJ="selected",t=" ",h="tree",K="tree-node",aT=function(){return Array.prototype.slice.call(arguments).join(t);},ar=function(A){return(A instanceof af.TreeNode);},aR=function(A){return(A instanceof af.TreeView);},H=af.getClassName,ai=H(p,aL),B=H(h,x),b=H(h,a),aE=H(h,v),aZ=H(h,j),u=H(h,X),ax=H(h,J),G=H(h,V),k=H(h,al),aH=H(h,q),F=H(h,q,ad),ay=H(h,q,X,J),i=H(h,q,aK),aO=H(h,q,an),L=H(h,q,aJ),ae='<div class="'+ax+'"></div>',r='<div class="'+G+'"></div>',d='<div class="'+k+'"></div>',aW="<ul></ul>",w='<li class="'+aH+'"></li>',ab='<div class="'+aT(ai,F)+'"></div>';var O=af.Component.create({NAME:K,ATTRS:{boundingBox:{valueFn:function(){return af.Node.create(w);}},contentBox:{valueFn:function(){return af.Node.create(ab);}},draggable:{value:true,validator:aF},ownerTree:{value:null},label:{value:Q,validator:aP},expanded:{value:false,validator:aF},id:{validator:aP,valueFn:function(){return af.guid();}},leaf:{value:true,setter:function(A){if(A&&this.get(g).length){return false;}return A;},validator:aF},nextSibling:{getter:"_getSibling",value:null,validator:ar},prevSibling:{getter:"_getSibling",value:null,validator:ar},parentNode:{value:null,validator:function(A){return ar(A)||aR(A);}},labelEl:{setter:af.one,valueFn:function(){var A=this.get(al);return af.Node.create(d).html(A).unselectable();}},hitAreaEl:{setter:af.one,valueFn:function(){return af.Node.create(ae);}},alwaysShowHitArea:{value:true,validator:aF},iconEl:{setter:af.one,valueFn:function(){return af.Node.create(r);}},tabIndex:{value:null},rendered:{validator:aF,value:false}},AUGMENTS:[af.TreeData],EXTENDS:af.Base,prototype:{BOUNDING_TEMPLATE:w,CONTENT_TEMPLATE:ab,initializer:function(){var A=this;var a2=A.get(s);a2.setData(K,A);A._syncTreeNodeBBId();A._uiSetExpanded(A.get(j));A._uiSetLeaf(A.get(aK));},bindUI:function(){var A=this;A.after("childrenChange",af.bind(A._afterSetChildren,A));A.after("expandedChange",af.bind(A._afterExpandedChange,A));A.after("idChange",A._afterSetId,A);A.after("leafChange",af.bind(A._afterLeafChange,A));},render:function(a2){var A=this;if(!A.get(aV)){A.renderUI();A.bindUI();A.syncUI();A.set(aV,true);}if(a2){A.get(s).appendTo(a2);}},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;A._syncHitArea(A.get(g));},_afterExpandedChange:function(a2){var A=this;A._uiSetExpanded(a2.newVal);},_afterLeafChange:function(a2){var A=this;A._uiSetLeaf(a2.newVal);},_afterSetChildren:function(a2){var A=this;A._syncHitArea(a2.newVal);},_renderContentBox:function(a4){var A=this;var a2=A.get(v);if(!A.isLeaf()){var a3=A.get(j);a2.addClass(a3?aZ:B);if(a3){A.expand();}}return a2;},_renderBoundingBox:function(){var A=this;var a3=A.get(s);var a2=A.get(v);var a4=null;a2.append(A.get(aX));a2.append(A.get(Y));a3.append(a2);var a4=A.get(a);if(a4){if(!A.get(j)){a4.addClass(u);}a3.append(a4);}return a3;},_createNodeContainer:function(){var A=this;var a2=A.get(a)||af.Node.create(aW);a2.addClass(b);A.set(a,a2);return a2;},_syncHitArea:function(a2){var A=this;if(A.get(aY)||a2.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){af.TreeNode.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;A.set(j,false);},collapseAll:function(){var A=this;af.TreeNode.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;A.set(j,true);},expandAll:function(){var A=this;af.TreeNode.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var a2=this;var a3=0;var A=a2.get(e);while(A){++a3;A=A.get(e);}return a3;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&af.TreeNode.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){return this.get(v).hasClass(L);},isLeaf:function(){var A=this;return A.get(aK);},isAncestor:function(a3){var a2=this;var A=a2.get(e);while(A){if(A===a3){return true;}A=A.get(e);}return false;},toggle:function(){var A=this;if(A.get(j)){A.collapse();}else{A.expand();}},select:function(){var A=this;var a2=A.get(aa);if(a2){a2.set(T,A);}A.get(v).addClass(L);A.fire("select");},unselect:function(){var A=this;A.get(v).removeClass(L);A.fire("unselect");},over:function(){this.get(v).addClass(aO);},out:function(){this.get(v).removeClass(aO);},showHitArea:function(){var A=this;var a2=A.get(f);a2.removeClass(ay);},hideHitArea:function(){var A=this;var a2=A.get(f);a2.addClass(ay);},_syncTreeNodeBBId:function(a2){var A=this;A.get(s).attr(av,A.get(av));},_getSibling:function(a5,a2){var A=this;var a4="_"+a2;var a3=A[a4];if(a3!==null&&!ar(a3)){a3=null;A[a4]=a3;}return a3;},_uiSetExpanded:function(a4){var A=this;if(!A.isLeaf()){var a3=A.get(a);var a2=A.get(v);if(a4){a2.replaceClass(B,aZ);if(a3){a3.removeClass(u);}}else{a2.replaceClass(aZ,B);if(a3){a3.addClass(u);}}}},_uiSetLeaf:function(a3){var A=this;var a2=A.get(v);if(a3){A.get(a).remove();A.get(f).remove();}else{a2.prepend(A.get(f));A._createNodeContainer();A._uiSetExpanded(A.get(j));}a2.toggleClass(i,a3);}}});af.TreeNode=O;var aA=U.isFunction,I=U.isObject,ag=U.isValue,aQ="cache",aw="end",am="io",aG="limit",aU="loaded",a0="loading",aC="Load more results",ak="paginator",ap="start",au="tree-node-io",c="paginatorClick",aD=H(h,q,ak),z=H(h,q,am,a0),az='<a class="'+aD+'" href="javascript:void(0);">{moreResultsLabel}</a>';var N=af.Component.create({NAME:au,ATTRS:{io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);}},loading:{value:false,validator:aF},loaded:{value:false,validator:aF},cache:{value:true,validator:aF},leaf:{value:false,validator:aF},paginator:{setter:function(a3){var a2=this;
var A=af.Node.create(U.sub(az,{moreResultsLabel:a3.moreResultsLabel||aC}));return af.merge({alwaysVisible:false,autoFocus:true,element:A,endParam:aw,limitParam:aG,start:0,startParam:ap},a3);},validator:I}},EXTENDS:af.TreeNode,prototype:{bindUI:function(){var A=this;af.TreeNodeIO.superclass.bindUI.apply(this,arguments);A._bindPaginatorUI();A._createEvents();},syncUI:function(){var A=this;af.TreeNodeIO.superclass.syncUI.apply(this,arguments);A._syncPaginatorUI();},_bindPaginatorUI:function(){var A=this;var a3=A.get(ak);if(a3){var a2=af.bind(A._handlePaginatorClickEvent,A);a3.element.on("click",a2);}},createNodes:function(a2){var A=this;af.Array.each(af.Array(a2),function(a4){var a3=A.createNode.call(A,a4);A.appendChild(a3);});A._syncPaginatorUI(a2);},expand:function(){var A=this;var a2=A.get(aQ);var a5=A.get(am);var a3=A.get(aU);var a4=A.get(a0);if(!a2){A.set(aU,false);}if(a5&&!a3&&!a4&&!this.hasChildNodes()){if(!a2){A.empty();}A.initIO();}else{af.TreeNodeIO.superclass.expand.apply(this,arguments);}},initIO:function(){var a2=this;var a3=a2.get(am);if(aA(a3.cfg.data)){a3.cfg.data=a3.cfg.data.call(a2,a2);}a2._syncPaginatorIOData(a3);if(aA(a3.loader)){var A=af.bind(a3.loader,a2);A(a3.url,a3.cfg,a2);}else{af.io.request(a3.url,a3.cfg);}},ioStartHandler:function(){var A=this;var a2=A.get(v);A.set(a0,true);a2.addClass(z);},ioCompleteHandler:function(){var A=this;var a2=A.get(v);A.set(a0,false);A.set(aU,true);a2.removeClass(z);},ioSuccessHandler:function(){var a9=this;var a5=a9.get(am);var a8=a9.get(aa);var a6=Array.prototype.slice.call(arguments);var a3=a6.length;var A=a6[1];if(a3>=3){var a2=a6[2];try{A=af.JSON.parse(a2.responseText);}catch(a4){}}var a7=a5.formatter;if(a7){A=a7(A);}a9.createNodes(A);a9.expand();if(a8&&a8.ddDelegate){a8.ddDelegate.syncTargets();}},ioFailureHandler:function(){var A=this;A.set(a0,false);A.set(aU,false);},_createEvents:function(){var A=this;A.publish(c,{defaultFn:A._defPaginatorClickFn,prefix:au});},_defPaginatorClickFn:function(a2){var A=this;var a3=A.get(ak);if(ag(a3.limit)){a3.start+=a3.limit;}if(A.get(am)){A.initIO();}},_handlePaginatorClickEvent:function(a4){var A=this;var a3=A.get(aa);var a2=A.getEventOutputMap(A);A.fire(c,a2);if(a3){a3.fire(c,a2);}a4.halt();},_inheritOwnerTreeAttrs:function(){var a2=this;var a3=a2.get(aa);if(a3){if(!a2.get(am)){a2.set(am,af.clone(a3.get(am)));}if(!a2.get(ak)){var A=a3.get(ak);if(A&&A.element){A.element=A.element.clone();}a2.set(ak,A);}}},_setIO:function(a3){var A=this;if(!a3){return null;}else{if(aP(a3)){a3={url:a3};}}a3=a3||{};a3.cfg=a3.cfg||{};a3.cfg.on=a3.cfg.on||{};var a2={start:af.bind(A.ioStartHandler,A),complete:af.bind(A.ioCompleteHandler,A),success:af.bind(A.ioSuccessHandler,A),failure:af.bind(A.ioFailureHandler,A)};af.each(a2,function(a6,a4){var a7=a3.cfg.on[a4];if(aA(a7)){var a5=function(){a6.apply(A,arguments);a7.apply(A,arguments);};a3.cfg.on[a4]=af.bind(a5,A);}else{a3.cfg.on[a4]=a6;}});return a3;},_syncPaginatorIOData:function(a4){var A=this;var a3=A.get(ak);if(a3&&ag(a3.limit)){var a2=a4.cfg.data||{};a2[a3.limitParam]=a3.limit;a2[a3.startParam]=a3.start;a2[a3.endParam]=(a3.start+a3.limit);a4.cfg.data=a2;}},_syncPaginatorUI:function(a4){var a8=this;var a2=a8.get(g);var a9=a8.get(ak);if(a9){var a7=true;if(a4){a7=(a4.length>0);}var a3=a8.getChildrenLength();var A=a9.start;var a6=a9.total||a3;var ba=a7&&(a6>a3);if(a9.alwaysVisible||ba){a8.get(a).append(a9.element.show());if(a9.autoFocus){try{a9.element.focus();}catch(a5){}}}else{a9.element.hide();}}}}});af.TreeNodeIO=N;var l="checkbox",o="checked",ac="checkContainerEl",aM="checkEl",P="checkName",Z=".",m="name",C="tree-node-check",aj=H(h,q,l),aq=H(h,q,l,a),at=H(h,q,o),S='<div class="'+aq+'"></div>',ao='<input class="'+aj+'" type="checkbox" />';var aI=af.Component.create({NAME:C,ATTRS:{checked:{value:false,validator:aF},checkName:{value:C,validator:aP},checkContainerEl:{setter:af.one,valueFn:function(){return af.Node.create(S);}},checkEl:{setter:af.one,valueFn:function(){var A=this.get(P);return af.Node.create(ao).attr(m,A);}}},EXTENDS:af.TreeNodeIO,prototype:{initializer:function(){var A=this;A._uiSetChecked(A.get(o));},renderUI:function(){var a2=this;af.TreeNodeCheck.superclass.renderUI.apply(a2,arguments);var a3=a2.get(Y);var A=a2.get(aM);var a4=a2.get(ac);A.hide();a4.append(A);a3.placeBefore(a4);if(a2.isChecked()){a2.check();}},bindUI:function(){var A=this;var a2=A.get(v);var a3=A.get(Y);af.TreeNodeCheck.superclass.bindUI.apply(A,arguments);A.after("checkedChange",af.bind(A._afterCheckedChange,A));a2.delegate("click",af.bind(A.toggleCheck,A),Z+aq);a2.delegate("click",af.bind(A.toggleCheck,A),Z+k);a3.swallowEvent("dblclick");},check:function(a2){var A=this;A.set(o,true,{originalTarget:a2});},uncheck:function(a2){var A=this;A.set(o,false,{originalTarget:a2});},toggleCheck:function(){var a2=this;var A=a2.get(aM);var a3=A.attr(o);if(!a3){a2.check();}else{a2.uncheck();}},isChecked:function(){var A=this;return A.get(o);},_afterCheckedChange:function(a2){var A=this;A._uiSetChecked(a2.newVal);},_uiSetChecked:function(a2){var A=this;if(a2){A.get(v).addClass(at);A.get(aM).attr(o,o);}else{A.get(v).removeClass(at);A.get(aM).attr(o,Q);}}}});af.TreeNodeCheck=aI;var D="child",R="tree-node-task",M="unchecked",aN=function(A){return A instanceof af.TreeNodeCheck;},ah=H(h,q,D,M);var a1=af.Component.create({NAME:R,EXTENDS:af.TreeNodeCheck,prototype:{check:function(a3){var A=this;var a2=A.get(v);a3=a3||A;if(!A.isLeaf()){A.eachChildren(function(a4){if(aN(a4)){a4.check(a3);}});}A.eachParent(function(a4){if(aN(a4)&&!a4.isChecked()){a4.get(v).addClass(ah);}});a2.removeClass(ah);af.TreeNodeTask.superclass.check.call(this,a3);},uncheck:function(a3){var A=this;var a2=A.get(v);a3=a3||A;if(!A.isLeaf()){A.eachChildren(function(a4){if(a4 instanceof af.TreeNodeCheck){a4.uncheck(a3);}});}A.eachParent(function(a4){if(aN(a4)&&!a4.isChecked()){a4.get(v).removeClass(ah);}});a2.removeClass(ah);af.TreeNodeTask.superclass.uncheck.call(this,a3);}}});af.TreeNodeTask=a1;var E="tree-node-radio",n=function(A){return A instanceof af.TreeNodeRadio;
},y=H(h,q,aB),W=H(h,q,aB,o);var aS=af.Component.create({NAME:E,EXTENDS:af.TreeNodeTask,prototype:{renderUI:function(){var A=this;af.TreeNodeRadio.superclass.renderUI.apply(A,arguments);A.get(v).addClass(y);},check:function(){var A=this;A._uncheckNodesRadio();af.TreeNodeRadio.superclass.check.apply(this,arguments);},_uiSetChecked:function(a2){var A=this;if(a2){A.get(v).addClass(W);A.get(aM).attr(o,o);}else{A.get(v).removeClass(W);A.get(aM).attr(o,Q);}},_uncheckNodesRadio:function(a4){var A=this;var a3;if(a4){a3=a4.get(g);}else{var a2=A.get(aa);if(a2){a3=a2.get(g);}else{return;}}af.Array.each(a3,function(a6,a5,a7){if(!a6.isLeaf()){A._uncheckNodesRadio(a6);}if(n(a6)){a6.uncheck();}});}}});af.TreeNodeRadio=aS;af.TreeNode.nodeTypes={radio:af.TreeNodeRadio,task:af.TreeNodeTask,check:af.TreeNodeCheck,node:af.TreeNode,io:af.TreeNodeIO};},"@VERSION@",{skinnable:false,requires:["aui-tree-data","aui-io","json","querystring-stringify"]});