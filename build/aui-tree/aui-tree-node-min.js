AUI.add("aui-tree-node",function(ai){var ac=ai.Lang,aR=ac.isString,aH=ac.isBoolean,a0="alwaysShowHitArea",T="",t="boundingBox",h="children",aN="clearfix",y="collapsed",a="container",ag="content",w="contentBox",k="expanded",q="helper",Z="hidden",g="hitAreaEl",M="hitarea",X="icon",aZ="iconEl",ay="id",ao="label",aa="labelEl",W="lastSelected",aM="leaf",r="node",aq="over",ad="ownerTree",f="parentNode",aE="radio",aX="rendered",aL="selected",u=" ",i="tree",N="tree-node",aV=function(){return Array.prototype.slice.call(arguments).join(u);},av=function(A){return(A instanceof ai.TreeNode);},aT=function(A){return(A instanceof ai.TreeView);},J=ai.getClassName,al=J(q,aN),C=J(i,y),c=J(i,a),aG=J(i,w),a1=J(i,k),v=J(i,Z),aA=J(i,M),H=J(i,X),l=J(i,ao),aJ=J(i,r),G=J(i,r,ag),aB=J(i,r,Z,M),j=J(i,r,aM),aQ=J(i,r,aq),O=J(i,r,aL),ah='<div class="'+aA+'"></div>',s='<div class="'+H+'"></div>',e='<div class="'+l+'"></div>',aY="<ul></ul>",x='<li class="'+aJ+'"></li>',ae='<div class="'+aV(al,G)+'"></div>';var R=ai.Component.create({NAME:N,ATTRS:{alwaysShowHitArea:{validator:aH,value:true},boundingBox:{valueFn:function(){return ai.Node.create(x);}},contentBox:{valueFn:function(){return ai.Node.create(ae);}},draggable:{validator:aH,value:true},expanded:{validator:aH,value:false},hitAreaEl:{setter:ai.one,valueFn:function(){return ai.Node.create(ah);}},iconEl:{setter:ai.one,valueFn:function(){return ai.Node.create(s);}},id:{validator:aR,valueFn:function(){return ai.guid();}},label:{validator:aR,value:T},labelEl:{setter:ai.one,valueFn:function(){var A=this.get(ao);return ai.Node.create(e).html(A).unselectable();}},leaf:{setter:function(A){if(A&&this.get(h).length){return false;}return A;},validator:aH,value:true},nextSibling:{getter:"_getSibling",validator:av,value:null},ownerTree:{value:null},parentNode:{validator:function(A){return av(A)||aT(A);},value:null},prevSibling:{getter:"_getSibling",validator:av,value:null},rendered:{validator:aH,value:false},tabIndex:{value:null}},AUGMENTS:[ai.TreeData],EXTENDS:ai.Base,prototype:{BOUNDING_TEMPLATE:x,CONTENT_TEMPLATE:ae,initializer:function(){var A=this;var a5=A.get(t);var a4=A.get(k);var L=A.get(aM);a5.setData(N,A);A._syncTreeNodeBBId();A._uiSetExpanded(a4);A._uiSetLeaf(L);},bindUI:function(){var A=this;A.after("childrenChange",ai.bind(A._afterSetChildren,A));A.after("expandedChange",ai.bind(A._afterExpandedChange,A));A.after("idChange",A._afterSetId,A);A.after("leafChange",ai.bind(A._afterLeafChange,A));},render:function(L){var A=this;var a4=A.get(t);var a5=A.get(aX);if(!a5){A.renderUI();A.bindUI();A.syncUI();A.set(aX,true);}if(L){a4.appendTo(L);}},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;var L=A.get(h);A._syncHitArea(L);},_afterExpandedChange:function(a4){var A=this;var L=a4.newVal;A._uiSetExpanded(L);},_afterLeafChange:function(a4){var A=this;var L=a4.newVal;A._uiSetLeaf(L);},_afterSetChildren:function(a4){var A=this;var L=a4.newVal;A._syncHitArea(L);},_renderContentBox:function(a5){var A=this;var L=A.get(w);if(!A.isLeaf()){var a4=A.get(k);L.addClass(a4?a1:C);if(a4){A.expand();}}return L;},_renderBoundingBox:function(){var L=this;var a7=L.get(t);var a4=L.get(w);var a5=L.get(k);var A=L.get(aZ);var a6=L.get(aa);var a8=L.get(a);a4.append(A);a4.append(a6);a7.append(a4);if(a8){if(!a5){a8.addClass(v);}a7.append(a8);}return a7;},_createNodeContainer:function(){var A=this;var L=A.get(a)||ai.Node.create(aY);L.addClass(c);A.set(a,L);return L;},_syncHitArea:function(L){var A=this;var a4=A.get(a0);if(a4||L.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){ai.TreeNode.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;A.set(k,false);},collapseAll:function(){var A=this;ai.TreeNode.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;A.set(k,true);},expandAll:function(){var A=this;ai.TreeNode.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var a4=0;var L=this;var A=L.get(f);while(A){++a4;A=A.get(f);}return a4;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&ai.TreeNode.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){var A=this;var L=A.get(w);return L.hasClass(O);},isLeaf:function(){var A=this;return A.get(aM);},isAncestor:function(a4){var L=this;var A=L.get(f);while(A){if(A===a4){return true;}A=A.get(f);}return false;},toggle:function(){var A=this;var L=A.get(k);if(L){A.collapse();}else{A.expand();}},select:function(){var A=this;var L=A.get(w);var a4=A.get(ad);if(a4){a4.set(W,A);}L.addClass(O);A.fire("select");},unselect:function(){var A=this;var L=A.get(w);L.removeClass(O);A.fire("unselect");},over:function(){var A=this;var L=A.get(w);L.addClass(aQ);},out:function(){var A=this;var L=A.get(w);L.removeClass(aQ);},showHitArea:function(){var A=this;var L=A.get(g);L.removeClass(aB);},hideHitArea:function(){var A=this;var L=A.get(g);L.addClass(aB);},_syncTreeNodeBBId:function(a5){var A=this;var a4=A.get(t);var a5=A.get(ay);var L={ID:a5};a4.attr(L);},_getSibling:function(a6,L){var A=this;var a5="_"+L;var a4=A[a5];if(a4!==null&&!av(a4)){a4=null;A[a5]=a4;}return a4;},_uiSetExpanded:function(a5){var A=this;if(!A.isLeaf()){var a4=A.get(a);var L=A.get(w);if(a5){L.replaceClass(C,a1);if(a4){a4.removeClass(v);}}else{L.replaceClass(a1,C);if(a4){a4.addClass(v);}}}},_uiSetLeaf:function(a6){var A=this;var a4=A.get(a);var L=A.get(w);var a5=A.get(k);var a7=A.get(g);if(a6){a4.remove();a7.remove();}else{L.prepend(a7);A._createNodeContainer();A._uiSetExpanded(a5);}L.toggleClass(j,a6);}}});ai.TreeNode=R;var aD=ac.isFunction,K=ac.isObject,aj=ac.isValue,aS="cache",az="end",ap="io",aI="limit",aW="loaded",a2="loading",an="paginator",at="start",ax="tree-node-io",d="paginatorClick",aF=J(i,r,an),B=J(i,r,ap,a2),aC='<a class="'+aF+'" href="javascript:void(0);">Load more results</a>';var Q=ai.Component.create({NAME:ax,ATTRS:{cache:{validator:aH,value:true},io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);
}},leaf:{validator:aH,value:false},loaded:{validator:aH,value:false},loading:{validator:aH,value:false},paginator:{setter:function(A){return ai.merge({alwaysVisible:false,autoFocus:true,element:ai.Node.create(aC),endParam:az,limitParam:aI,start:0,startParam:at},A);},validator:K}},EXTENDS:ai.TreeNode,prototype:{bindUI:function(){var A=this;ai.TreeNodeIO.superclass.bindUI.apply(this,arguments);A._bindPaginatorUI();A._createEvents();},syncUI:function(){var A=this;ai.TreeNodeIO.superclass.syncUI.apply(this,arguments);A._syncPaginatorUI();},_bindPaginatorUI:function(){var A=this;var a4=A.get(an);if(a4){var L=ai.bind(A._handlePaginatorClickEvent,A);a4.element.on("click",L);}},createNodes:function(L){var A=this;ai.Array.each(ai.Array(L),function(a5){var a4=A.createNode.call(A,a5);A.appendChild(a4);});A._syncPaginatorUI(L);},expand:function(){var A=this;var L=A.get(aS);var a6=A.get(ap);var a4=A.get(aW);var a5=A.get(a2);if(!L){A.set(aW,false);}if(a6&&!a4&&!a5&&!this.hasChildNodes()){if(!L){A.empty();}A.initIO();}else{ai.TreeNodeIO.superclass.expand.apply(this,arguments);}},initIO:function(){var L=this;var a4=L.get(ap);if(aD(a4.cfg.data)){a4.cfg.data=a4.cfg.data.call(L,L);}L._syncPaginatorIOData(a4);if(aD(a4.loader)){var A=ai.bind(a4.loader,L);A(a4.url,a4.cfg,L);}else{ai.io.request(a4.url,a4.cfg);}},ioStartHandler:function(){var A=this;var L=A.get(w);A.set(a2,true);L.addClass(B);},ioCompleteHandler:function(){var A=this;var L=A.get(w);A.set(a2,false);A.set(aW,true);L.removeClass(B);},ioSuccessHandler:function(){var A=this;var a9=A.get(ap);var a4=Array.prototype.slice.call(arguments);var a6=a4.length;var L=a4[1];if(a6>=3){var a8=a4[2];try{L=ai.JSON.parse(a8.responseText);}catch(a7){}}var a5=a9.formatter;if(a5){L=a5(L);}A.createNodes(L);A.expand();},ioFailureHandler:function(){var A=this;A.set(a2,false);A.set(aW,false);},_createEvents:function(){var A=this;A.publish(d,{defaultFn:A._defPaginatorClickFn,prefix:ax});},_defPaginatorClickFn:function(L){var A=this;var a4=A.get(an);if(aj(a4.limit)){a4.start+=a4.limit;}if(A.get(ap)){A.initIO();}},_handlePaginatorClickEvent:function(a5){var A=this;var a4=A.get(ad);var L=A.getEventOutputMap(A);A.fire(d,L);if(a4){a4.fire(d,L);}a5.halt();},_inheritOwnerTreeAttrs:function(){var L=this;var a5=L.get(ap);var a4=L.get(ad);if(a4){if(!a5){L.set(ap,ai.clone(a4.get(ap)));}if(!L.get(an)){var A=a4.get(an);if(A&&A.element){A.element=A.element.clone();}L.set(an,A);}}},_setIO:function(a4){var A=this;if(!a4){return null;}else{if(aR(a4)){a4={url:a4};}}a4=a4||{};a4.cfg=a4.cfg||{};a4.cfg.on=a4.cfg.on||{};var L={start:ai.bind(A.ioStartHandler,A),complete:ai.bind(A.ioCompleteHandler,A),success:ai.bind(A.ioSuccessHandler,A),failure:ai.bind(A.ioFailureHandler,A)};ai.each(L,function(a7,a5){var a8=a4.cfg.on[a5];if(aD(a8)){var a6=function(){a7.apply(A,arguments);a8.apply(A,arguments);};a4.cfg.on[a5]=ai.bind(a6,A);}else{a4.cfg.on[a5]=a7;}});return a4;},_syncPaginatorIOData:function(a5){var A=this;var a4=A.get(an);if(a4&&aj(a4.limit)){var L=a5.cfg.data||{};L[a4.limitParam]=a4.limit;L[a4.startParam]=a4.start;L[a4.endParam]=(a4.start+a4.limit);a5.cfg.data=L;}},_syncPaginatorUI:function(a5){var a9=this;var L=a9.get(h);var ba=a9.get(an);if(ba){var a8=true;if(a5){a8=(a5.length>0);}var a4=a9.getChildrenLength();var A=ba.start;var a7=ba.total||a4;var bb=a8&&(a7>a4);if(ba.alwaysVisible||bb){a9.get(a).append(ba.element.show());if(ba.autoFocus){try{ba.element.focus();}catch(a6){}}}else{ba.element.hide();}}}}});ai.TreeNodeIO=Q;var m="checkbox",p="checked",af="checkContainerEl",b="CheckboxContainer",aO="checkEl",I="Checkbox",S="checkName",ab=".",n="name",D="tree-node-check",am=J(i,r,m),au=J(i,r,m,a),aw=J(i,r,p),V='<div class="'+au+'"></div>',ar='<input class="'+am+'" type="checkbox" />';var aK=ai.Component.create({NAME:D,ATTRS:{checked:{validator:aH,value:false},checkContainerEl:{setter:ai.one,valueFn:function(){var A=this;var a5=A.get(ay);var a4=a5+b;var L={ID:a4};return ai.Node.create(V).attr(L);}},checkEl:{setter:ai.one,valueFn:function(){var A=this;var a5=A.get(S);var a6=A.get(ay);var a4=a6+I;var L={ID:a4,NAME:a5};return ai.Node.create(ar).attr(L);}},checkName:{validator:aR,value:D}},EXTENDS:ai.TreeNodeIO,prototype:{initializer:function(){var A=this;var L=A.get(p);A._uiSetChecked(L);},renderUI:function(){var L=this;ai.TreeNodeCheck.superclass.renderUI.apply(L,arguments);var a4=L.get(aa);var A=L.get(aO);var a5=L.get(af);A.hide();a5.append(A);a4.placeBefore(a5);if(L.isChecked()){L.check();}},bindUI:function(){var A=this;var L=A.get(w);var a4=A.get(aa);ai.TreeNodeCheck.superclass.bindUI.apply(A,arguments);A.after("checkedChange",ai.bind(A._afterCheckedChange,A));L.delegate("click",ai.bind(A.toggleCheck,A),ab+au);L.delegate("click",ai.bind(A.toggleCheck,A),ab+l);a4.swallowEvent("dblclick");},check:function(L){var A=this;A.set(p,true,{originalTarget:L});},uncheck:function(L){var A=this;A.set(p,false,{originalTarget:L});},toggleCheck:function(){var L=this;var A=L.get(aO);var a4=A.attr(p);if(!a4){L.check();}else{L.uncheck();}},isChecked:function(){var A=this;var L=A.get(p);return L;},_afterCheckedChange:function(a4){var A=this;var L=a4.newVal;A._uiSetChecked(L);},_uiSetChecked:function(a6){var L=this;var A=L.get(aO);var a4=L.get(w);var a5={};if(a6){a4.addClass(aw);A.attr(p,p);}else{a4.removeClass(aw);A.attr(p,T);}}}});ai.TreeNodeCheck=aK;var E="child",U="tree-node-task",P="unchecked",aP=function(A){return A instanceof ai.TreeNodeCheck;},ak=J(i,r,E,P);var a3=ai.Component.create({NAME:U,EXTENDS:ai.TreeNodeCheck,prototype:{check:function(a4){var A=this;var L=A.get(w);a4=a4||A;if(!A.isLeaf()){A.eachChildren(function(a5){if(aP(a5)){a5.check(a4);}});}A.eachParent(function(a5){if(aP(a5)&&!a5.isChecked()){a5.get(w).addClass(ak);}});L.removeClass(ak);ai.TreeNodeTask.superclass.check.call(this,a4);},uncheck:function(a4){var A=this;var L=A.get(w);a4=a4||A;if(!A.isLeaf()){A.eachChildren(function(a5){if(a5 instanceof ai.TreeNodeCheck){a5.uncheck(a4);}});}A.eachParent(function(a5){if(aP(a5)&&!a5.isChecked()){a5.get(w).removeClass(ak);
}});L.removeClass(ak);ai.TreeNodeTask.superclass.uncheck.call(this,a4);}}});ai.TreeNodeTask=a3;var F="tree-node-radio",o=function(A){return A instanceof ai.TreeNodeRadio;},z=J(i,r,aE),Y=J(i,r,aE,p);var aU=ai.Component.create({NAME:F,EXTENDS:ai.TreeNodeTask,prototype:{renderUI:function(){var A=this;var L=A.get(w);ai.TreeNodeRadio.superclass.renderUI.apply(A,arguments);L.addClass(z);},check:function(){var A=this;A._uncheckNodesRadio();ai.TreeNodeRadio.superclass.check.apply(this,arguments);},_uiSetChecked:function(a6){var L=this;var A=L.get(aO);var a4=L.get(w);var a5={};if(a6){a4.addClass(Y);A.attr(p,p);}else{a4.removeClass(Y);A.attr(p,T);}},_uncheckNodesRadio:function(a5){var A=this;var a4;if(a5){a4=a5.get(h);}else{var L=A.get(ad);if(L){a4=L.get(h);}else{return;}}ai.Array.each(a4,function(a7,a6,a8){if(!a7.isLeaf()){A._uncheckNodesRadio(a7);}if(o(a7)){a7.uncheck();}});}}});ai.TreeNodeRadio=aU;ai.TreeNode.nodeTypes={radio:ai.TreeNodeRadio,task:ai.TreeNodeTask,check:ai.TreeNodeCheck,node:ai.TreeNode,io:ai.TreeNodeIO};},"@VERSION@",{skinnable:false,requires:["aui-tree-data","aui-io","json","querystring-stringify"]});