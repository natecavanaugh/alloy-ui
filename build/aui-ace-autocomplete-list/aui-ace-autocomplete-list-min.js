AUI.add("aui-ace-autocomplete-list",function(o){var U=o.Lang,r=o.Array,B=o.Do,S="exec",h="processor",i=-1,N=0,C="ace-autocomplete-base";var l=function(){};l.prototype={initializer:function(){var A=this;A._editorCommands=[];o.after(this._bindUIACBase,this,"renderUI");},_bindUIACBase:function(){var A=this;A.publish("cursorChange",{defaultFn:A._defaultCursorChangeFn});var V=A._getEditor();V.on("change",o.bind(A._onEditorChange,A));V.commands.addCommand({name:"showAutoComplete",bindKey:o.merge(A.get("showListKey"),{sender:"editor|cli"}),exec:function(Y,X,Z){var W=V.getCursorPosition();A._processAutoComplete(W.row,W.column);}});V.getSelection().on("changeCursor",o.bind(A._onEditorChangeCursor,A));A.on("destroy",A._destroyUIACBase,A);},_destroyUIACBase:function(){var A=this;A._removeAutoCompleteCommands();},_defaultCursorChangeFn:function(A){var aa=this;var X=aa._getEditor();var V=X.getCursorPosition();var ab=V.row;var W=V.column;var Y=aa._enteringParams;if(ab!==Y.row||W<Y.match.start){aa.fire("cursorOut");}else{var ac=X.getSession().getLine(ab);var Z=ac.substring(Y.match.start,W);if(!aa.get(h).getMatch(Z)){aa.fire("match");}}},_getEditor:function(){var A=this;return A.get("host").getEditor();},_handleEnter:function(Y){var A=this;if(Y==="\n"||Y==="\t"){var V=A._getEditor();var X=A._getSelectedEntry();var W=A.get(h).getSuggestion(A._enteringParams.match,X);V.insert(W);V.focus();A.fire("addSuggestion",W);return new B.Halt(null);}},_onEditorChange:function(Z){var A=this;var aa=Z.data;var ab=aa.action;if(ab==="insertText"||ab==="removeText"){var X=aa.range;var Y=X.start.column;var W=X.end.row;var V=X.start.row;if(ab==="insertText"&&V===W){A._processAutoComplete(V,Y+1);}A.fire(ab,{column:Y,dataRange:X,endRow:W,startRow:V});}},_onEditorChangeCursor:function(V){var A=this;A.fire("cursorChange",A._getEditor().getCursorPosition());},_onResponseError:function(A){},_onResultsSuccess:function(V){var A=this;A.set("results",V);},_overwriteCommands:function(){var V=this;var W=V._getEditor();var A=W.commands.commands;V._editorCommands.push(B.before(V._handleEnter,W,"onTextInput",this),B.before(V._handleKey,A["golinedown"],S,this,40),B.before(V._handleKey,A["golineup"],S,this,38),B.before(V._handleKey,A["gotoend"],S,this,35),B.before(V._handleKey,A["gotolineend"],S,this,35),B.before(V._handleKey,A["gotolinestart"],S,this,36),B.before(V._handleKey,A["gotopagedown"],S,this,34),B.before(V._handleKey,A["gotopageup"],S,this,33),B.before(V._handleKey,A["gotostart"],S,this,36));},_processAutoComplete:function(ab,W){var aa=this;var V=W;var Y=aa._getEditor();var ac=Y.getSession().getLine(ab);ac=ac.substring(0,W);var A=aa.get(h);var X=A.getMatch(ac);var Z;if(U.isObject(X)){Z=Y.renderer.textToScreenCoordinates(ab,W);aa._enteringParams={column:W,match:X,row:ab};A.getResults(X,o.bind(aa._onResultsSuccess,aa),o.bind(aa._onResponseError,aa));}aa.fire("match",{column:W,coords:Z,line:ac,match:X,row:ab});},_removeAutoCompleteCommands:function(){var A=this;r.invoke(A._editorCommands,"detach");A._editorCommands.length=0;}};l.NAME=C;l.NS=C;l.ATTRS={processor:{validator:function(A){return U.isObject(A)||U.isFunction(A);}},showListKey:{validator:U.isObject,value:{mac:"Alt-Space",win:"Ctrl-Space"}}};o.AceEditor.AutoCompleteBase=l;var U=o.Lang,r=o.Array,B=o.Do,e=o.getClassName,P="data-index",C="aui-ace-autocomplete-list",b="container",t=".",c="empty",k="",D="entry",w="highlighted",G="list",s="loading",E="offsetHeight",x="region",Q="results",y="selected",a=" ",T="visible",n="ace-autocomplete",g=e(n,D),L=e(n,D,b),v=e(n,D,b,w),O=e(n,D,s),q=e(n,D,c),F=e(n,D,s),d=e(n,Q),K=t+L,m=K+t+y,R=m+a+t+g,p=40,j=35,M=34,u=33,f=36,I=38,H=5,J=20;var z=o.Component.create({NAME:C,NS:C,ATTRS:{emptyMessage:{validator:U.isString,value:"No suggestions"},host:{validator:U.isObject},listNode:{value:null},loadingMessage:{validator:U.isString,value:"Loading"},results:{validator:U.isArray},selectedEntry:{getter:"_getSelectedEntry"}},AUGMENTS:[o.AceEditor.AutoCompleteBase],CSS_PREFIX:n,EXTENDS:o.Panel,HTML_PARSER:{listNode:t+d},prototype:{bindUI:function(){var A=this;A.on("addSuggestion",A.hide,A);A.on("cursorChange",A._onCursorChange,A);A.on("cursorOut",A.hide,A);A.on("entrySelected",A._insertWord,A);A.on("insertText",A._onInsertText,A);A.on("match",A._onMatch,A);A.on("removeText",A._onRemoveText,A);A.on("resultsChange",A._onResultsChange,A);A.on("visibleChange",A._onVisibleChange);},renderUI:function(){var A=this;var V=A.get("listNode");if(!V){V=A._createListNode();}V.delegate("click",A._handleResultListClick,K,A);V.delegate("mouseenter",A._onMouseEnter,K,A);V.delegate("mouseleave",A._onMouseLeave,K);A._autoCompleteResultsList=V;},_createListNode:function(){var A=this;var V=o.Node.create(A.TPL_LIST);A.get("contentBox").append(V);return V;},_getEntriesPerPage:function(){var A=this;var W=A._entriesPerPage;if(!W){var V=A._autoCompleteResultsList;var X=V.one(K).get(E);var Y=V.get(E);W=Math.floor(Y/X);A._entriesPerPage=W;}return W;},_getSelectedEntry:function(){var A=this;var V;var W=A._autoCompleteResultsList.one(R);if(W){V=W.text();}return V;},_handleArrows:function(aa){var A=this;var Z;if(aa===I){Z="previous";}else{if(aa===p){Z="next";}}if(Z){var X=A._autoCompleteResultsList;var W=X.one(m);if(W){var Y=W[Z](K);if(Y){W.removeClass(y);Y.addClass(y);var ab=X.get(x);var V=Y.get(x);if(Z==="previous"){if(V.top<ab.top){Y.scrollIntoView(true);}}else{if(V.top+V.height>ab.bottom){Y.scrollIntoView();}}}}return new B.Halt(null);}},_handleKey:function(W,Y,X){var V=this;var A;if(V.get(T)){if(X===I||X===p){A=V._handleArrows(X);}else{if(X===u||X===M){A=V._handlePageUpDown(X);}else{if(X===j||X===f){A=V._handleStartEnd(X);}}}}return A;},_handlePageUpDown:function(ac){var aa=this;var X=aa._autoCompleteResultsList;var ab=aa._getEntriesPerPage();var Z=X.one(m);var A=parseInt(Z.attr(P),0);var Y;var ad=k;var V=false;if(ac===u){Y=A-ab;V=true;}else{if(ac===M){Y=A+ab;ad=":last-child";}}var W=X.one(K+"["+P+'="'+Y+'"]');if(!W){W=X.one(K+ad);}if(Z!==W){Z.removeClass(y);W.addClass(y);W.scrollIntoView(V);
}return new B.Halt(null);},_handleResultListClick:function(W){var A=this;var X=W.currentTarget;var V=A._autoCompleteResultsList.one(m);if(X!==V){V.removeClass(y);X.addClass(y);}A.fire("entrySelected",X);},_handleStartEnd:function(Z){var A=this;var X;var Y=false;var W=A._autoCompleteResultsList;if(Z===j){X=W.one(K+":last-child");}else{if(Z===f){X=W.one(K);Y=true;}}var V=W.one(m);if(X!==V){V.removeClass(y);X.addClass(y);X.scrollIntoView(Y);}return new B.Halt(null);},_onCursorChange:function(V){var A=this;if(!A.get(T)){V.preventDefault();}},_onInsertText:function(V){var A=this;if(V.startRow!==V.endRow&&A.get(T)){A.hide();}},_onMatch:function(V){var A=this;if(V.match){var W=V.coords;A.set("xy",[W.pageX+H,W.pageY+J]);if(!A.get(T)){A.show();}}else{if(A.get(T)){A.hide();}}},_onMouseEnter:function(A){A.currentTarget.addClass(v);},_onMouseLeave:function(A){A.currentTarget.removeClass(v);},_onRemoveText:function(V){var A=this;if(A.get(T)){A.hide();}},_onResultsChange:function(Z){var A=this;var V=A._autoCompleteResultsList;V.empty();var X=Z.newVal;var Y=A.TPL_ENTRY;r.each(X,function(ab,aa){V.appendChild(U.sub(Y,{index:aa,value:ab}));});var W=V.one(K);if(W){W.addClass(y);}else{V.appendChild(U.sub(A.TPL_RESULTS_EMPTY,{label:A.get("emptyMessage")}));}},_onVisibleChange:function(W){var A=this;var V=A._autoCompleteResultsList;if(W.newVal){A._overwriteCommands();}else{A._removeAutoCompleteCommands();V.empty();V.appendChild(U.sub(A.TPL_LOADING,{label:A.get("loadingMessage")}));}},TPL_ENTRY:'<li class="'+L+'" data-index="{index}">'+'<span class="'+g+'">{value}</span>'+"</li>",TPL_LIST:'<ul class="'+d+'"/>',TPL_LOADING:'<li class="'+L+'">'+'<span class="aui-icon-loading '+O+'">{label}</span>'+"</li>",TPL_RESULTS_EMPTY:'<li class="'+L+'">'+'<span class="'+q+'">{label}</span>'+"</li>"}});o.AceEditor.AutoCompleteList=z;o.AceEditor.AutoComplete=z;},"@VERSION@",{requires:["aui-ace-editor","panel"],skinnable:true});