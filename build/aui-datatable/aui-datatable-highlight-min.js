AUI.add("aui-datatable-highlight",function(r){var c=r.Lang,m=c.isArray,n=c.isString,l=c.isBoolean,h="active",t="activeBorderWidth",j="activeCell",d="activeCoordChange",a="activeRow",u="border",x="cells",f="children",z="highlight",q="highlightRange",y="host",k="overlay",g="overlayActiveNode",w="overlayNode",b="rangeBorderWidth",s="region",v="rows",i="selectionChange",o="type",B=" ",p=function(E){var C=this,D=0,A;if(n(E)){E=c.trim(E).replace(/\s+/g," ").split(B);}else{if(!m(E)){E=r.Array(E);}}for(A=4-E.length;D<A;D++){E.push(E[D]);}return r.Array.map(E,parseFloat);};var e=r.Base.create("datatable-highlight",r.Plugin.Base,[],{CLASS_NAMES:null,TPL_FRAME:'<div class="{overlay}">'+'<div class="{border}"></div>'+'<div class="{border}"></div>'+'<div class="{border}"></div>'+'<div class="{border}"></div>'+"</div>",_lastActiveRow:null,_nodes:null,initializer:function(){var A=this,C=A.get(y);A.CLASS_NAMES={active:C.getClassName(h),border:C.getClassName(z,u),highlight:C.getClassName(z),overlay:C.getClassName(z,k),overlayActive:C.getClassName(z,k,h)};A.afterHostEvent(d,A._afterActiveCoordChange);A.afterHostEvent(i,A._afterSelectionChange);},clear:function(){var A=this,D=A.get(y),C=D.get(j);if(C){C.removeClass(A.CLASS_NAMES.active);}A._clearBorders();A._clearHighlights();},getActiveRegion:function(){var A=this,D=A.get(y),C=A.get(o),E=null,F;if(C===v){F=D.get(a);}else{F=D.get(j);}if(F){E=F.get(s);}return E;},getSelectionRegion:function(){var A=this,E=A._nodes,D=E[0].get(s),C=E[E.length-1].get(s);return{0:D.top,1:D.left,bottom:C.bottom,height:C.bottom-D.top,left:D.left,right:C.right,top:D.top,width:C.right-D.left};},_afterActiveCoordChange:function(H){var A=this,G=A.get(y),F=A.get(t),D=A.get(g),I=A.CLASS_NAMES,E=G.get(a),C=A._lastActiveRow;if(!A.get(o)){return;}A.clear();if(C){C.removeClass(I.active);}if(E){A._alignBorder(D,A.getActiveRegion(),F);E.addClass(I.active);}A._lastActiveRow=E;},_afterSelectionChange:function(E){var A=this,C,G=A.get(q),D=A.get(w),F=A.get(b);if(!A.get(o)){return;}A._clearHighlights();C=A._collectNodes(E.newVal);if(G&&C&&(C.length>1)){A._alignBorder(D,A.getSelectionRegion(),F);r.Array.each(C,function(H){H.addClass(A.CLASS_NAMES.highlight);});}},_alignBorder:function(K,G,C){var H=this,I=H.get(y);I._tableNode.appendChild(K);if(G){var E=K.get(f),J=E.item(0),A=E.item(1),F=E.item(2),D=E.item(3);K.setXY([G.left,G.top]);J.sizeTo(G.width,C[0]);D.sizeTo(C[3],G.height-C[2]);F.sizeTo(G.width,C[2]);A.sizeTo(C[1],G.height-C[2]);J.setXY([G.left,G.top]);D.setXY([G.left,G.top]);F.setXY([G.left,G.bottom-C[2]]);A.setXY([G.right-C[1],G.top]);}},_collectNodes:function(D){var A=this,C=A.get(o);if(!C||!D){return null;}return(A._nodes=D[C]);},_clearBorders:function(){var A=this;A.get(w).remove();A.get(g).remove();},_clearHighlights:function(){var A=this;r.Array.each(A._nodes,function(C){C.removeClass(A.CLASS_NAMES.highlight);});},_validateType:function(A){return(A===x||A===v||A===null);}},{NS:z,NAME:"datatable-highlight",ATTRS:{activeBorderWidth:{setter:p,value:2},overlayActiveNode:{setter:function(D){var A=this,C=A.CLASS_NAMES;if(!D){D=r.Node.create(c.sub(A.TPL_FRAME,C));D.addClass(C.overlayActive);}return D;},value:null},overlayNode:{setter:function(C){var A=this;if(!C){C=r.Node.create(c.sub(A.TPL_FRAME,A.CLASS_NAMES));}return C;},value:null},highlightRange:{validator:l,value:true},rangeBorderWidth:{setter:p,value:1},type:{validator:"_validateType",value:x}}});r.namespace("Plugin").DataTableHighlight=e;},"@VERSION@",{skinnable:true,requires:["aui-datatable-selection"]});