AUI.add("aui-editor-base",function(a){var c=a.Lang,d="editor";var b=a.Component.create({NAME:d,EXTENDS:a.EditorBase,ATTRS:{toolbarConfig:{value:null}},prototype:{initializer:function(){var e=this;e.publish("toolbar:ready",{fireOnce:true});e.after("ready",function(){e.plug(a.Plugin.EditorToolbar,e.get("toolbarConfig"));e.fire("toolbar:ready");e.focus();});},addCss:function(f){var e=this;e.on("toolbar:ready",function(){var g=e.getInstance();g.Get.css(f);});},addGroup:function(f){var e=this;e.on("toolbar:ready",function(){e.toolbar.addGroup(f);});},addGroupType:function(f,g){var e=this;e.on("toolbar:ready",function(){e.toolbar.addGroupType(f,g);});}}});a.Editor=b;},"@VERSION@",{requires:["aui-base","editor-base","aui-editor-toolbar-plugin"]});AUI.add("aui-editor-tools-plugin",function(b){var e=b.Lang,f=b.UA,g="justify",j={div:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,p:true},l={br:true},c={li:true},d='<div style="text-align: {0};">{1}</div>';function k(n){var o=null;var p=n.get("childNodes");p.some(function(r,q,s){if(r.get("innerHTML")=="{0}"){r.html("");o=r;return true;}return k(r);});return o;}function m(o,p,n){var r=b.Node.create(n);o.insert(r,p);if(r.html()!=""){if(r.html()=="{0}"){r.html("");}else{var q=k(r);if(q){r=q;}}}return r;}function h(p,o){var n=(f.ie?"innerText":"textContent");return(p.get(n)==o.get(n));}var a={};b.mix(b.Plugin.ExecCommand.COMMANDS,{justify:function(q,p){var u=this;var v=u.get("host");var o=v.getInstance();var t=new o.Selection();var s=t.getSelected();var r=false;if(t.isCollapsed||!s.size()){var n=t.anchorTextNode;s=[n];r=true;}b.each(s,function(z,w,B){var x=z.get("tagName");if(x){x=x.toLowerCase();}if(l[x]){return;}if(x=="font"){var A=z.get("parentNode");if(!A.test("body")){z=A;x=z.get("tagName").toLowerCase();}}if(!z.test("body")&&z.getComputedStyle("textAlign")==p){return;}var y=z.get("parentNode");var C;if(j[x]||z.getComputedStyle("display")=="block"){C=z;}else{if(!y.get("childNodes").item(1)||c[x]){x=y.get("tagName").toLowerCase();if(j[x]||y.getComputedStyle("display")=="block"){C=y;}}else{if(r){v.execCommand("inserthtml",e.sub(d,[p,o.Selection.CURSOR]));t.focusCursor(true,true);return;}else{C=b.Node.create(e.sub(d,[p,""]));y.insert(C,z);C.append(z);}}}if(C){C.setStyle("textAlign",p);}});},justifycenter:function(){var n=this;return n.get("host").execCommand(g,"center");},justifyleft:function(){var n=this;return n.get("host").execCommand(g,"left");},justifyright:function(){var n=this;return n.get("host").execCommand(g,"right");},subscript:function(){var n=this;return n.get("host").execCommand("wrap","sub");},superscript:function(){var n=this;return n.get("host").execCommand("wrap","sup");},wraphtml:function(z,H){var E=this;var v=E.get("host");var t=v.getInstance();var G=new t.Selection();var w=G.getSelected();if(!G.isCollapsed&&w.size()){var y;var C;var r;var s;var n;if(w.size()>1){var F;var u;w.each(function(M,I,N){var J=M;var L=0;var K;while((J=J.ancestor())&&!J.test("body")){L++;K=J;}if(u==null||L<u){F=I;u=L;}});var D=w.item(F);var q=(D.test("font")?D.ancestor().ancestor():D.ancestor());var x=[];n=q.get("childNodes");w.each(function(K,I,L){var J=K;var M=-1;if(K.ancestor().test("body")){M=I;}else{while((J=J.ancestor())!=null){n.some(function(N,P,O){if(N==J){M=P;return true;}});if(M!=-1){break;}}}x[I]=M;});if(x.length>1){var o;var B;for(var A=0;A<x.length;A++){if(x[A]!=-1){if(x[A]<o||o==null){o=x[A];y=w.item(A);C=n.item(o);}if(x[A]>B||B==null){B=x[A];r=w.item(A);s=n.item(B);}}else{C=null;break;}}}}if(C!=null&&((C==s)||(h(y,C)&&h(r,s)))){var q=C.ancestor();var p=m(q,C,H);for(var A=o;A<=B;A++){p.append(n.item(A));}}else{w.each(function(L,I,M){var J=L.get("tagName").toLowerCase();if(!l[J]){var K=L.ancestor();var N=m(K,L,H);N.append(L);}});}}else{v.execCommand("inserthtml",e.sub(H,[t.Selection.CURSOR]));if(H.indexOf("{0}")!=-1){G.focusCursor(true,true);}}}});b.Plugin.EditorTools=a;},"@VERSION@",{requires:["aui-base","editor-base"]});AUI.add("aui-editor-menu-plugin",function(d){var l=d.Lang,a=l.isString,f=d.getClassName,q="editormenu",c="editormenuplugin",n="menu",r="content",b=f(q,r,"list"),h=f(q,r,"text"),k=f(q,r,"item"),o="<{1}{2}>{0}</{1}>",m='<li class="'+k+'">'+o+"</li>",e='<ul class="'+b+'"></ul>',j='<li class="'+h+'"><span>{0}</span></li>';var g=d.Component.create({NAME:q,EXTENDS:d.OverlayContext,ATTRS:{headerContent:{value:"",setter:function(t){var s=this;s._headerContent=t;return"";}},host:{value:false},items:{value:null}},prototype:{renderUI:function(){var s=this;g.superclass.renderUI.apply(s,arguments);var y=s.get("host");var u=s.get("contentBox");var w=s._headerContent;var v=s.get("items");var x=d.Node.create(e);d.each(v,function(D,B,E){var A="";if(a(D)){A+=l.sub(j,[D]);}else{var z=s._generateTagAttr(D);A+=l.sub(m,[D.label,D.tag,z]);}var C=d.Node.create(A);C.setData(q,D);x.append(C);});var t=new d.Panel({collapsible:false,headerContent:w,icons:[{icon:"close",handler:{fn:s.hide,context:s}}]}).render(u);t.bodyNode.append(x);s._menuList=x;},bindUI:function(){var s=this;g.superclass.bindUI.apply(s,arguments);s._menuList.delegate("click",s._onMenuListItemClick,"."+k,s);},_generateTagAttr:function(y){var s=this;var t=[];var v="";var u=y.attributes;var x=y.styles;if(u){for(var w in u){t.push(" "+w+'="'+u[w]+'"');}}if(x){t=[' style="'];for(var w in x){t.push(w+": "+x[w]+";");}t.push('"');}return t.join("");},_onMenuListItemClick:function(y){var t=this;var x=y.currentTarget;var v=x.getData(q);var s=t._generateTagAttr(v);var u=l.sub(o,["{0}",v.tag,s]);var w=t.get("host");w.execCommand("wraphtml",u);w.focus();t.hide();},_uiSetHeight:function(v){var s=this;var t=s.get("boundingBox");var u=s._menuList;t.setStyle("height","auto");u.setStyle("height",v);},_uiSetWidth:function(v){var s=this;var t=s.get("boundingBox");var u=s._menuList;t.setStyle("width","auto");u.setStyle("width",v);}}});var p=d.Component.create({EXTENDS:d.Plugin.Base,NAME:c,NS:n,prototype:{add:function(t){var s=this;var u=s.get("host");return new g(d.mix({host:u},t)).render();}}});d.namespace("Plugin").EditorMenu=p;
},"@VERSION@",{requires:["aui-base","editor-base","aui-overlay-context","aui-panel","aui-editor-tools-plugin"]});AUI.add("aui-editor-toolbar-plugin",function(t){var ao=t.Lang,x=t.Array,G=ao.isArray,u=ao.isFunction,aj=t.getClassName,M="editortoolbar",am="toolbar",w="align-block",aa="align-inline",H="align-left",an="align-right",y="alignment",O="color",T="content",q="font",ah="indent",m="input",V="insert",J="insertimage",ab="insertlink",F="left",W="list",ai="right",z="select",c="source",K="start",n="styles",ad="subscript",ac="text",R="circle-check",a="close",af={backcolor:true,forecolor:true,format:true,insertimage:true,insertlink:true,source:true,styles:true},C=["b","big","font","em","i","small","s","strike","strong","sub","sup","u"],r=aj("button","holder"),s=aj("field",m),B=aj("field",m,"text"),h=aj("field","label"),L=aj("field","numeric"),o=aj(M,"align","node"),D=aj(M,J),l=aj(M,ab),b=aj(M,z,"fontname"),ag=aj(M,z,"fontsize"),f=aj(M,"size","separator"),j=aj(M,c,"textarea"),e=aj("state","active"),k=aj(M),E=aj(M,T),U='<div class="'+o+'"></div>',p="<a></a>",I="<img />",Q='<a href="{0}"{2}>{1}</a>',g='<textarea class="'+j+'"></textarea>',al='<div class="'+k+'"><div class="'+E+'"></div></div>',Y='<div class="'+r+'"></div>',ak='<select class="'+b+'">{0}</select>',v='<option selected="selected"></option>'+"<option>Arial</option>"+"<option>Arial Black</option>"+"<option>Comic Sans MS</option>"+"<option>Courier New</option>"+"<option>Lucida Console</option>"+"<option>Tahoma</option>"+"<option>Times New Roman</option>"+"<option>Trebuchet MS</option>"+"<option>Verdana</option>",Z='<select class="'+ag+'">{0}</select>',S='<option selected="selected"></option>'+'<option value="1">10</option>'+'<option value="2">13</option>'+'<option value="3">16</option>'+'<option value="4">18</option>'+'<option value="5">24</option>'+'<option value="6">32</option>'+'<option value="7">48</option>',P='<span class="'+f+'">x</span>';var N=t.Component.create({NAME:M,NS:am,EXTENDS:t.Plugin.Base,ATTRS:{append:{value:null},groups:{value:[{type:q},{type:ac},{type:O},{type:y},{type:ah},{type:W},{type:V},{type:c}]}},_alignNode:null,prototype:{initializer:function(){var aG=this;var ap=t.Node.create(U);var aE=aG.get("append");var at=t.Node.create(al);var aw=at.one("."+E);var aH=aG.get("groups");var ax=aG.get("host");var av=ax.frame.get("container");av.placeBefore(at);aG._boundingBox=at;aG._contentBox=aw;ap.hide();t.getBody().append(ap);aG._alignNode=ap;var ay=[];if(G(aE)){var az=aE.length;for(var aC=0;aC<az;aC++){var aF=aE[aC];if(aF.index!=null){var aq=aG._isGroupIncluded("type",aH,aF.type);if(aq!=-1){aH.splice(aq,1);}aH.splice(Math.min(aF.index,aH.length),0,aF);}else{aH.push(aF);}}}for(aC=0;aC<aH.length;aC++){var ar=aH[aC];var aA=X[ar.type]||ar;var aD=[];if(G(ar.include)){var A=ar.include.length;for(var aB=0;aB<A;aB++){aq=aG._isGroupIncluded("icon",aA.children,ar.include[aB]);if(aq!=-1){aD.push(aA.children[aq]);}}}else{aD=aA.children;}var au=aG._addGroup(ar,aA,aD);if(au){ay.push(au);}}aG._toolbars=ay;aw.delegate("click",function(aL){var aJ=this;var aK=t.Widget.getByNode(aL.currentTarget);if(aK){var aI=aK.get("icon").split("-");if(!af[aI[0]]){aJ.execCommand(aI[0],(aI[1]?aI[1]:""));aJ.focus();}}},"button",ax);},addGroup:function(aq){var A=this;var ap=X[aq.type]||aq;A._addGroup(aq,ap);},addGroupType:function(ap,aq){var A=this;if(!X[ap]){X[ap]=aq;}},_addGroup:function(at,az,aD){var aG=this;var ap=(aD==null&&at.index!=null);aD=aD||az.children;if(G(aD)){var aw=aG.get("host");var av=aG._contentBox;var aq=[];var au;var ay={boundingBox:aG._boundingBox,contentBox:av};for(var aC=0;aC<aD.length;aC++){var A=aD[aC];if(!A.select){var aI=YUI.AUI.defaults.EditorToolbar.STRINGS[A._titleKey];A.title=(aI!=null?aI:ae[A._titleKey]);aq.push(A);}}if(aq.length){au=new t.Toolbar(t.merge(az.config,at.toolbar,{children:aq})).render(av);}var aA=az.generate;if(aA&&u(aA.init)){aA.init.call(aG,aw,ay);}if(az.radio){au.after("buttonitem:click",aG._deactivateItems,aG,au);}aq=(aq.length?aq:aD);for(aC=0;aC<aq.length;aC++){var aF=aq[aC];var aE=aF.icon;if(aA&&u(aA[aE])){var aH=(at.config?at.config[aE]:null);ay.button=(aF.select||!au?null:au.item(aC));aA[aE].call(aG,aw,ay,aH);}}if(ap){var ax=av.get("childNodes");var aB=ax.size();var ar=at.index;if(ar<aB-1){av.insert(ax.item(aB-1),ax.item(ar));}}return au;}return null;},_deactivateItems:function(aq,ap){var A=aq.target;ap.each(function(at,ar,au){if(at!=A){at.StateInteraction.set("active",false);}});},_handleAlign:function(ar,aq){var ap=ar.changedNode;var A=ar.commands;var at=ap.getStyle("textAlign")||K;if(at&&at.toLowerCase()==="start"){at=F;if(ap.getStyle("direction")==="rtl"){at=ai;}}if(at){A["justify"+at]=1;}},_handleFontName:function(au,ar){var aq=au.changedNode;var A=au.commands;var ap=ar._fontNameOptions;if(ap){var at=au.fontFamily;ap.item(0).set("selected",true);ap.each(function(aw,av,ay){var ax=aw.get("value").toLowerCase();if(ax===at.toLowerCase()){aw.set("selected",true);}});}},_handleFontSize:function(at,aq){var ap=at.changedNode;var A=at.commands;var au=at.fontSize;var ar=aq._fontSizeOptions;if(ar){au=au.replace("px","");ar.item(0).set("selected",true);ar.each(function(ax,aw,az){var ay=ax.get("value").toLowerCase();var av=ax.get("text");if(av===au){ax.set("selected",true);}});}},_isGroupIncluded:function(ap,ar,at){var A=this;for(var aq=0;aq<ar.length;aq++){if(ar[aq][ap]==at){return aq;}}return -1;},_onNodeChange:function(ar,aq){var ap=this;var A=ar.commands;var at=ap._toolbars;ap._handleAlign(ar,aq);ap._handleFontSize(ar,aq);ap._handleFontName(ar,aq);ap._updateToolbar(A);},_openOverlayToAlignNode:function(aq,ap,ar){var au=this;var aw=ar.get("docScrollX");var av=ar.get("docScrollY");var ax=ap.getXY();var at=ar.getXY();ax=[ax[0]+at[0]-aw,ax[1]+at[1]-av];var A=au._alignNode;A.setStyle("width",ar.get("offsetWidth"));A.setStyle("height",ar.get("offsetHeight"));A.setXY(ax);A.show();aq.set("align",{node:A,points:["tl","bc"]});aq.show();},_updateToolbar:function(ap){var A=this;x.each(A._toolbars,function(ar,aq,at){ar.each(function(av,au,ax){var aw=!!(ap[av.get("icon")]);
av.StateInteraction.set("active",aw);});});}}});function d(aq){var A=this;var at=aq.currentTarget;var ap=at.get("className");var ar=ap.substring(ap.lastIndexOf("-")+1);var au=at.get("value");A.execCommand(ar,au);A.focus();}N.generateOverlay=function(ar,aq,A){var ap=new t["OverlayContext"+(A?"Panel":"")](t.merge({align:{node:ar,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:ar},aq)).render();return ap;};N.generateColorPicker=function(av,ar,aq,aw){var au=ar.button;var ap=au.get("boundingBox");var A=new t.ColorPicker(t.merge({align:{node:ap,points:["tl","bl"]},trigger:ap},aq));if(aq&&aq.plugins){for(var at=0;at<aq.plugins.length;at++){A.plug(aq.plugins[at],aq);}}A.render(t.getBody());A.on("colorChange",function(az){var ax=this;var ay=A.get("rgb");av.execCommand(aw,ay.hex);av.focus();});};var ae={ALIGN:"Align",ALIGN_BLOCK:"Block",ALIGN_INLINE:"Inline",ALIGN_LEFT:"Left",ALIGN_RIGHT:"Right",BACKCOLOR:"Background Color",BOLD:"Bold",BORDER:"Border",DESCRIPTION:"Description",EDIT_IMAGE:"Edit Image",EDIT_LINK:"Edit Link",FORECOLOR:"Foreground Color",IMAGE_URL:"Image URL",INDENT:"Indent",INSERT:"Insert",INSERT_IMAGE:"Insert Image",INSERT_LINK:"Insert Link",INSERT_ORDERED_LIST:"Insert Numbered List",INSERT_UNORDERED_LIST:"Insert Bulleted List",ITALIC:"Italic",JUSTIFY_CENTER:"Justify Center",JUSTIFY_LEFT:"Justify Left",JUSTIFY_RIGHT:"Justify Right",LINE_THROUGH:"Line Through",LINK_URL:"Link URL",OPEN_IN_NEW_WINDOW:"Open in new window",OUTDENT:"Outdent",PADDING:"Padding",REMOVE_FORMAT:"Format Source",SAVE:"Save",SIZE:"Size",SOURCE:"Source",STYLES:"Styles",SUBSCRIPT:"Subscript",SUPERSCRIPT:"Superscript",UNDERLINE:"Underline"};if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}t.mix(YUI.AUI.defaults.EditorToolbar.STRINGS,ae);var X={};X[y]={children:[{activeState:true,icon:"justifyleft",_titleKey:"JUSTIFY_LEFT"},{activeState:true,icon:"justifycenter",_titleKey:"JUSTIFY_CENTER"},{activeState:true,icon:"justifyright",_titleKey:"JUSTIFY_RIGHT"}],radio:true};X[O]={children:[{icon:"forecolor",_titleKey:"FORECOLOR"},{icon:"backcolor",_titleKey:"BACKCOLOR"}],generate:{forecolor:function(ar,aq,ap){var A=this;N.generateColorPicker(ar,aq,ap,"forecolor");},backcolor:function(ar,aq,ap){var A=this;N.generateColorPicker(ar,aq,ap,"backcolor");}}};X[q]={children:[{icon:"fontname",select:true},{icon:"fontsize",select:true}],generate:{init:function(ar,aq){var A=this;var ap=aq.contentBox;ar.after("nodeChange",function(au){var at=this;switch(au.changedType){case"keyup":case"mousedown":at._onNodeChange(au,aq);break;}},A);},fontname:function(au,at,ar){var A=this;var ap=at.contentBox;var av;var aw=[v];if(ar&&ar.optionHtml){aw[0]=ar.optionHtml;}av=t.Node.create(ao.sub(ak,aw));ap.append(av);av.on("change",d,au);var aq=ap.all("."+b+" option");at._fontNameOptions=aq;return av;},fontsize:function(au,at,ar){var A=this;var ap=at.contentBox;var av;var aw=[S];if(ar&&ar.optionHtml){aw[0]=ar.optionHtml;}av=t.Node.create(ao.sub(Z,aw));ap.append(av);av.on("change",d,au);var aq=ap.all("."+ag+" option");at._fontSizeOptions=aq;return av;}}};X[ah]={children:[{icon:ah,_titleKey:"INDENT"},{icon:"outdent",_titleKey:"OUTDENT"}]};X[V]={children:[{icon:"insertimage",_titleKey:"INSERT_IMAGE"},{icon:"insertlink",_titleKey:"INSERT_LINK"}],generate:{insertimage:function(ar,aA,aJ){var aH=this;var A=aA.button;var av=A.get("boundingBox");var aG=N.generateOverlay(av,aJ,true);var aD=aG.get("contentBox");var ay=new t.Panel({collapsible:false,title:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_IMAGE,icons:[{icon:a,handler:{fn:aG.hide,context:aG}}]}).render(aD);aD=ay.bodyNode;if(aJ&&aJ.dataBrowser){aJ.dataBrowser.render(aD);}else{var au;var aK;var aI=new t.Form({cssClass:D,labelAlign:F}).render(aD);var ax=[{labelText:"none",value:"none"}];for(var aE=1;aE<6;aE++){ax.push({labelText:aE+"px",value:aE+"px solid"});}aI.add([{id:"imageURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.IMAGE_URL},{id:"size",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.SIZE,type:"hidden"},{id:"width",labelText:false,cssClass:L},{id:"height",labelText:false,cssClass:L},{id:"padding",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.PADDING},new t.Select({id:"border",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.BORDER,options:ax}),{id:"align",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN,type:"hidden"},{id:"description",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.DESCRIPTION},{id:"linkURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);aI.getField("width").get("boundingBox").placeAfter(P);var at=aI.get("contentBox");var aF=t.Node.create(Y);var az=aI.getField("openInNewWindow");var aC=new t.ButtonItem({icon:R,label:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT}).render(aF);aC.on("click",function(aM){var aW=this;var aN;var aQ;var aU;if(au){aQ=au;aU=au.get("parentNode");if(aU.get("tagName").toLowerCase()=="a"){aN=aU;}}else{aQ=t.Node.create(I);}var aP=aI.get("fieldValues");var aV=aP.description;var aR={src:aP.imageURL,title:aV,alt:aV};var aT={border:aP.border};var aX=parseInt(aP.height,10);var aO=parseInt(aP.width,10);if(!isNaN(aX)){aR.height=aX;}if(!isNaN(aO)){aR.width=aO;}var aS=parseInt(aP.padding,10);if(!isNaN(aS)){aT.padding=aS;}aB.some(function(a0,aZ,a2){var aY=this;var a1=a0.StateInteraction.get("active");if(a1){aT.display="";switch(aZ){case 0:aR.align=F;break;case 1:aR.align="";break;case 2:aR.align="center";aT.display="block";break;case 3:aR.align=ai;break;}return true;}return false;});aQ.setAttrs(aR);aQ.setStyles(aT);var aL=aP.linkURL;if(aL){if(!aN){aN=t.Node.create(p);if(au){aU.insert(aN,au);}aN.append(aQ);}aN.setAttribute("href",aL);aN.setAttribute("target",(az.get("node").get("checked")?"_blank":""));aQ=aN;}else{if(au&&aN){aU.insert(au,aN);aN.remove(true);}}if(!au&&aK&&aK.anchorNode){aK.anchorNode.append(aQ);}aG.hide();});var aw=t.Node.create(I);var ap=aI.getField("height");var aq=aI.getField("width");
aw.on("load",function(aM){var aL=aM.currentTarget;if(!ap.get("value")||!aq.get("value")){aI.set("values",{height:aL.get("height"),width:aL.get("width")});}});aI.getField("imageURL").get("node").on("blur",function(aL){aw.set("src",this.val());});at.append(aF);var aB=new t.Toolbar({children:[{activeState:true,icon:H,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_LEFT},{activeState:true,icon:aa,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_INLINE},{activeState:true,icon:w,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_BLOCK},{activeState:true,icon:an,title:YUI.AUI.defaults.EditorToolbar.STRINGS.ALIGN_RIGHT}]});aB.render(aI.getField("align").get("contentBox"));aG.on("show",function(aL){if(!aK||!aK.anchorNode){var aM=ar.getInstance();ar.focus();aK=new aM.Selection();}});aG.after("hide",function(aL){aI.resetValues();aB.each(function(aN,aM,aO){aN.StateInteraction.set("active",false);});az.get("node").set("checked",false);ay.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_IMAGE);aC.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT);aH._alignNode.hide();aG.set("align",{node:av,points:["tl","bl"]});au=null;});ar.on("toolbar:ready",function(){var aL=ar.frame._iframe;var aM=ar.getInstance();aL.on("mouseout",function(aN){aK=new aM.Selection();});aM.one("body").delegate("click",t.bind(function(aS){var aN=this;if(au!=aS.currentTarget){var aP=aS.currentTarget;var aR=aP.get("parentNode");var aO=aP.getStyle("borderWidth");var aT=aP.getStyle("padding");var aU=(aR.get("tagName").toLowerCase()=="a");aI.set("values",{border:(aO?aO+" solid":""),description:aP.get("alt"),height:aP.get("height"),imageURL:aP.get("src"),linkURL:(aU?aR.get("href"):""),width:aP.get("width"),padding:(aT?parseInt(aT,10):"")});var aQ=1;switch(aP.getAttribute("align")){case F:aQ=0;break;case"center":aQ=2;break;case ai:aQ=3;break;}aB.item(aQ).StateInteraction.set("active",true);az.get("node").attr("checked",(aU&&aR.getAttribute("target")=="_blank"));ay.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.EDIT_IMAGE);aC.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.SAVE);au=aP;aN._openOverlayToAlignNode(aG,aL,aP);}},aH),"img");});}},insertlink:function(ax,aD,ap){var aE=this;var aw=aD.button;var at=aw.get("boundingBox");var au=N.generateOverlay(at,ap,true);var aB=au.get("contentBox");var A=new t.Panel({collapsible:false,title:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT_LINK,icons:[{icon:a,handler:{fn:au.hide,context:au}}]}).render(aB);aB=A.bodyNode;var ar=ax.frame._iframe;var aA;var aC;var av=new t.Form({cssClass:l,labelAlign:F}).render(aB);av.add([{id:"description",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.DESCRIPTION},{id:"linkURL",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.LINK_URL},{id:"openInNewWindow",labelText:YUI.AUI.defaults.EditorToolbar.STRINGS.OPEN_IN_NEW_WINDOW,type:"checkbox"}],true);var az=av.get("contentBox");var ay=t.Node.create(Y);var aF=av.getField("openInNewWindow");var aq=new t.ButtonItem({icon:R,label:YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT}).render(ay);aq.on("click",function(aI){var aG=this;var aH=av.get("fieldValues");if(aA){aA.setAttribute("href",aH.linkURL);aA.set("innerHTML",aH.description);if(aF.get("node").get("checked")){aA.setAttribute("target","_blank");}else{aA.setAttribute("target","");}}else{ax.execCommand("inserthtml",ao.sub(Q,[aH.linkURL,aH.description,(aF.get("node").get("checked")?' target="_blank"':"")]));}au.hide();});az.append(ay);au.after("hide",function(aG){av.resetValues();aF.get("node").set("checked",false);A.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.CREATE_LINK);aq.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.INSERT);aE._alignNode.hide();au.set("align",{node:at,points:["tl","bl"]});aA=null;});ax.on("toolbar:ready",function(){var aG=ax.getInstance();aG.one("body").delegate("click",t.bind(function(aK){var aH=this;if(aA!=aK.currentTarget){var aJ=aK.currentTarget;if(!aJ.one("img")){var aI=aJ.get("parentNode");av.set("values",{description:aJ.get("innerHTML"),linkURL:aJ.getAttribute("href")});aF.get("node").attr("checked",(aJ.getAttribute("target")=="_blank"));A.set("title",YUI.AUI.defaults.EditorToolbar.STRINGS.EDIT_LINK);aq.set("label",YUI.AUI.defaults.EditorToolbar.STRINGS.SAVE);aA=aJ;aH._openOverlayToAlignNode(au,ar,aJ);}}},aE),"a");});}}};X[W]={children:[{activeState:true,icon:"insertunorderedlist",_titleKey:"INSERT_UNORDERED_LIST"},{activeState:true,icon:"insertorderedlist",_titleKey:"INSERT_ORDERED_LIST"}],generate:{init:function(ap){var A=this;ap.plug(t.Plugin.EditorLists);}},radio:true};X[c]={children:[{icon:"format",_titleKey:"REMOVE_FORMAT"},{icon:"source",_titleKey:"SOURCE"}],generate:{format:function(at,aq,ap){var A=this;var ar=aq.button;ar.on("click",function(ax){var au=this;var ay=au.getInstance();var aw=new ay.Selection();var av=aw.getSelected();if(!aw.isCollapsed&&av.size()){av.each(function(aF,aB,aG){var az=this;aF.removeAttribute("style");var aD=aF.get("innerHTML");aD=aD.replace(/<([a-zA-Z0-9]*)\b[^>]*>/g,"<$1>");for(var aC=0;aC<C.length;aC++){var aA=new RegExp("(<"+C[aC]+">|<\\/"+C[aC]+">)","ig");aD=aD.replace(aA,"");}aF.set("innerHTML",aD);var aE=aF.get("parentNode");if(!aE.test("body")){aE.removeAttribute("style");}});}},at);},source:function(av,at,ar){var A=this;var aq=at.contentBox;var au=at.button;var aw;var ap=t.Node.create(g);av.on("toolbar:ready",function(){var ax=this;var az=av.frame;var ay=az.get("container");ap.hide();ay.append(ap);});au._visible=false;au.on("click",function(aB){var ax=this;var aC=av.frame;var az=au._visible;if(az){ax.set("content",ap.val());ap.hide();ap.val("");aC.show();}else{var aA=aC._iframe;ap.val(ax.getContent());var ay=aA.get("offsetHeight")-ap.getPadding("tb");ap.setStyle("height",ay);aC.hide();ap.show();}az=!az;au._visible=az;aq.all("select").attr("disabled",az);aq.all("button").attr("disabled",az);au.get("contentBox").attr("disabled",false);},av);}}};X[n]={children:[{icon:"styles",_titleKey:"STYLES"}],generate:{styles:function(au,ar,aq){var A=this;var at=ar.button;var ap=at.get("boundingBox");
au.plug(t.Plugin.EditorMenu);au.menu.add(t.merge({align:{node:ap,points:["tl","bl"]},hideOn:"click",showOn:"click",trigger:ap},aq));}}};X[ad]={children:[{icon:"subscript",_titleKey:"SUBSCRIPT"},{icon:"superscript",_titleKey:"SUPERSCRIPT"}]};X[ac]={children:[{activeState:true,icon:"bold",_titleKey:"BOLD"},{activeState:true,icon:"italic",_titleKey:"ITALIC"},{activeState:true,icon:"underline",_titleKey:"UNDERLINE"},{activeState:true,icon:"strikethrough",_titleKey:"LINE_THROUGH"}]};t.namespace("Plugin").EditorToolbar=N;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-button-item","aui-color-picker","aui-editor-menu-plugin","aui-editor-tools-plugin","aui-form-select","aui-overlay-context-panel","aui-panel","aui-toolbar","createlink-base","editor-lists","editor-base","plugin"]});AUI.add("aui-editor-bbcode-plugin",function(r){var e=r.Lang,n=e.isArray,o=e.isString,k=r.getClassName,j="bbcodeplugin",q="bbcode",m="quote",w=m,p=w+"-content",y=w+"-title",s="\\[(({0})=([^\\]]*))\\]([\\s\\S]*?)\\[\\/{0}\\]",u="\\[({0})\\]([\\s\\S]*?)\\[\\/{0}\\]",d="<{0}(>|\\b[^>]*>)([\\s\\S]*?)</{0}>",f="<(([a-z0-9]+)\\b[^>]*?style=(\"|').*?{0}\\s*:\\s*([^;\"']+);?[^>]*)>([\\s\\S]*?)<(/\\2)>",h="(<[a-z0-9]+[^>]*>|</[a-z0-9]+>)",l='<div class="'+w+'"><div class="'+p+'">',g="</div></div>",c='<div class="'+y+'">$1</div>'+l,t=new RegExp(h,"gi"),v=[{convert:[["br"]],regExp:"<{0}[^>]*>",output:"\n"},{convert:[["&nbsp;"]],regExp:"{0}",output:" "},{convert:[{tags:["font-family"],source:["font"]},{tags:["font-size"],source:["size"]},{tags:["[^a-z-]*color"],source:["color"]}],regExp:f,output:"<$1>[{0}=$4]$5[/{0}]<$6>"},{convert:[{tags:["font-style"],source:["i"]},{tags:["font-weight"],source:["b"]}],regExp:f,output:"<$1>[{0}]$5[/{0}]<$6>"},{convert:[["text-decoration"]],regExp:f,output:function(){var A="";var z=arguments[4].toLowerCase();if(z.indexOf("underline")!=-1){A+="[u]";}else{if(z.indexOf("line-through")!=-1){A+="[s]";}}if(A!=""){return"<"+arguments[1]+">"+A+arguments[5]+A.replace("[","[/")+"<"+arguments[6]+">";}return arguments[0];}},{convert:[["margin-left"]],regExp:f,output:function(){var A="";var B=parseInt(arguments[3],10);if(!isNaN(B)){var C=Math.floor(B/40);for(var z=0;z<C;z++){A+="[indent]";}}A=A+arguments[5]+A.replace(/\[/g,"[/");return"<"+arguments[1]+">"+A+"<"+arguments[6]+">";}},{convert:[{tags:["font","size"],source:["size"]},{tags:["font","face"],source:["font"]}],regExp:"(<{0}\\b[^>]*{1}=(\"|')([^\"']+)(\"|')[^>]*>)([\\s\\S]*?)(</{0}>)",output:"$1[{0}=$3]$5[/{0}]$6"},{convert:[["text-align"]],regExp:f,output:"<$1>[$4]$5[/$4]<$6>"},{convert:[["quote"]],regExp:"<div\\b[^>]*class=(\"|')([^\"']*?)_"+w+"[^\"']*(\"|')[^>]*>([\\s\\S]*?)</div>",output:"$4"},{convert:[["span"]],regExp:d,output:"$2"},{convert:[["blockquote"]],regExp:d,output:"[indent]$2[/indent]"},{convert:[["b"],["strong"]],regExp:d,output:"[b]$2[/b]"},{convert:[["i"],["em"]],regExp:d,output:"[i]$2[/i]"},{convert:[["u"]],regExp:d,output:"[u]$2[/u]"},{convert:[["s"],["strike"]],regExp:d,output:"[s]$2[/s]"},{convert:[["img"]],regExp:"(<a[^>]*>)?<{0}\\b[^>]*src=(\"|')([^\"']+)(\"|')[^>]*>(</a>)?",output:"[img]$3[/img]"},{convert:[["a"]],regExp:"<{0}\\b[^>]*href=(\"|')mailto:([^\"']+)(\"|')[^>]*>([\\s\\S]*?)</{0}>",output:"[email=$2]$4[/email]"},{convert:[["a"]],regExp:"<{0}\\b[^>]*href=(\"|')([^\"']+)(\"|')[^>]*>([\\s\\S]*?)</{0}>",output:"[url=$2]$4[/url]"},{convert:[["center"]],regExp:d,output:"[center]$2[/center]"},{convert:[["ul"]],regExp:d,output:"[list]$2[/list]"},{convert:[["ol"]],regExp:d,output:"[list=1]$2[/list]"},{convert:[["li"]],regExp:d,output:"[*]$2"},{convert:[["code"]],regExp:d,output:"[code]$2[/code]"},{convert:[["div"]],regExp:d,output:"$2\n"},{convert:[["h1"],["h2"],["h3"],["h4"],["h5"],["h6"]],regExp:d,output:"[b]$2[/b]\n"},{convert:[["p"]],regExp:d,output:"\n$2\n"},{convert:[{tags:["list","left|center|right"],source:["list"]}],regExp:"(\\[{0}[^\\]]*\\])\\s*\\[({1})\\]([\\s\\S]*?)\\[/\\2\\]\\s*\\[/{0}\\]",output:"[$2]$1$3[/{0}][/$2]"}],b=[{convert:[{tags:["b"],source:["b"]},{tags:["i"],source:["i"]},{tags:["u"],source:["u"]},{tags:["s"],source:["s"]},{tags:["code"],source:["code"]}],regExp:u,output:"<{0}>$2</{0}>"},{convert:[{tags:["color"],source:["color"]}],regExp:s,output:'<span style="{0}: $3;">$4</span>'},{convert:[{tags:["font"],source:["face"]},{tags:["size"],source:["size"]}],regExp:s,output:'<font {0}="$3">$4</font>'},{convert:[["img"]],regExp:u,output:'<img src="$2" alt="" />'},{convert:[{tags:["email"],source:["mailto:"]},{tags:["url"],source:[""]}],regExp:s,output:'<a href="{0}$3">$4</a>'},{convert:[["list"]],regExp:"\\[({0}(=1)?)]([\\s\\S]*?)\\[\\/{0}\\]",output:function(){var B="";if(arguments[1]=="list=1"){B+="<ol>";}else{B+="<ul>";}var z=e.trim(arguments[3]).split("[*]");for(var A=1;A<z.length;A++){B+="<li>"+z[A]+"</li>";}if(arguments[1]=="list=1"){B+="</ol>";}else{B+="</ul>";}return B;}},{convert:[{tags:["indent"],source:["blockquote"]}],regExp:u,output:"<{0}>$2</{0}>"},{convert:[["left"],["center"],["right"]],regExp:u+"\n?",output:'<div style="text-align: $1;">$2</div>'},{convert:[["\n"]],regExp:"{0}",output:"<br />"}];var x={};x[m]={children:[{icon:"quote",_titleKey:"QUOTE"}]};r.mix(r.Plugin.ExecCommand.COMMANDS,{quote:function(C,D){var z=this;var B=z.get("host");var A=l+"{0}"+g;B.execCommand("wraphtml",A);B.focus();}});if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}r.mix(YUI.AUI.defaults.EditorToolbar.STRINGS,{QUOTE:"Quote"});var a=r.Component.create({NAME:j,NS:q,EXTENDS:r.Plugin.Base,ATTRS:{host:{value:false}},prototype:{initializer:function(){var z=this;var A=z.get("host");A.addGroupType(m,x[m]);z.afterHostMethod("getContent",z.getBBCode,z);A.on("contentChange",z._contentChange,z);},getBBCode:function(){var z=this;var C=z.get("host");var D=C.getInstance();var E=D.one("body").cloneNode(true);var A;var B=function(N,H,F){var I;var M=N;do{if(M){I=M;}M=M.one("div."+p);}while(M);var L=I.get("parentNode");if(L.hasClass(m)){var K=L.previous();var J="["+m;if(K&&K.hasClass(y)){var G=K.get("innerHTML");
G=G.replace(t,"");J+="="+(G.charAt(G.length-1)==":"?G.substring(0,G.length-1):K.get("innerHTML"));K.remove(true);}J+="]"+I.get("innerHTML")+"[/"+m+"]\n";L.set("innerHTML",J);L.removeClass(m);L.addClass("_"+m);}};while(A=E.all("div."+w)){if(!A.size()){break;}A.each(B);}html=E.get("innerHTML");html=z._parseTagExpressions(v,html);html=html.replace(t,"");return new r.Do.AlterReturn(null,html);},getContentAsHtml:function(){var z=this;var A=z.get("host");return A.constructor.prototype.getContent.apply(A,arguments);},setContentAsBBCode:function(A){var z=this;var B=z.get("host");B.set("content",A);},_contentChange:function(A){var z=this;A.newVal=z._parseBBCode(A.newVal);A.stopImmediatePropagation();},_parseBBCode:function(A){var z=this;var B=A;B=B.replace(/\[quote=([^\]]*)\]/gi,c);B=B.replace(/\[quote\]/gi,l);B=B.replace(/\[\/quote\]\n?/gi,g);B=z._parseTagExpressions(b,B);return B;},_parseTagExpressions:function(J,F){var I=this;var E;var H;var z;var A;var K;for(var D=0;D<J.length;D++){E=J[D];H=E.convert;A=H.length;for(var C=0;C<A;C++){var B=E.output;z=H[C];if(n(z)){K=z;}else{K=z.tags;if(o(B)){B=e.sub(B,z.source);}}var G=e.sub(E.regExp,K);F=F.replace(new RegExp(G,"gi"),B);}}return F;}}});r.namespace("Plugin").EditorBBCode=a;},"@VERSION@",{requires:["aui-base","editor-base"]});AUI.add("aui-editor-creole-parser",function(a){var c=a.config.doc;if(!b){var b={};}if(!b.Simple){b.Simple={};}b.Simple.Base=function(d,e){if(!arguments.length){return;}this.grammar=d;this.grammar.root=new this.ruleConstructor(this.grammar.root);this.options=e;};b.Simple.Base.prototype={ruleConstructor:null,grammar:null,options:null,parse:function(e,f,d){if(d){for(i in this.options){if(typeof d[i]=="undefined"){d[i]=this.options[i];}}}else{d=this.options;}f=f.replace(/\r\n?/g,"\n");this.grammar.root.apply(e,f,d);if(d&&d.forIE){e.innerHTML=e.innerHTML.replace(/\r?\n/g,"\r\n");}}};b.Simple.Base.prototype.constructor=b.Simple.Base;b.Simple.Base.Rule=function(e){if(!arguments.length){return;}for(var d in e){this[d]=e[d];}if(!this.children){this.children=[];}};b.Simple.Base.prototype.ruleConstructor=b.Simple.Base.Rule;b.Simple.Base.Rule.prototype={regex:null,capture:null,replaceRegex:null,replaceString:null,tag:null,attrs:null,children:null,match:function(e,d){return e.match(this.regex);},build:function(g,f,d){var h;if(this.capture!==null){h=f[this.capture];}var j;if(this.tag){j=c.createElement(this.tag);g.appendChild(j);}else{j=g;}if(h){if(this.replaceRegex){h=h.replace(this.replaceRegex,this.replaceString);}this.apply(j,h,d);}if(this.attrs){for(var e in this.attrs){j.setAttribute(e,this.attrs[e]);if(d&&d.forIE&&e=="class"){j.className=this.attrs[e];}}}return this;},apply:function(d,f,n){var j=""+f;var h=[];if(!this.fallback.apply){this.fallback=new this.constructor(this.fallback);}while(true){var e=false;var m=false;for(var g=0;g<this.children.length;g++){if(typeof h[g]=="undefined"){if(!this.children[g].match){this.children[g]=new this.constructor(this.children[g]);}h[g]=this.children[g].match(j,n);}if(h[g]&&(!e||e.index>h[g].index)){e=h[g];m=this.children[g];if(e.index==0){break;}}}var l=e?e.index:j.length;if(l>0){this.fallback.apply(d,j.substring(0,l),n);}if(!e){break;}if(!m.build){m=new this.constructor(m);}m.build(d,e,n);var k=e.index+e[0].length;j=j.substring(k);for(var g=0;g<this.children.length;g++){if(h[g]){if(h[g].index>=k){h[g].index-=k;}else{h[g]=void 0;}}}}return this;},fallback:{apply:function(e,f,d){if(d&&d.forIE){f=f.replace(/\n/g," \r");}e.appendChild(c.createTextNode(f));}}};b.Simple.Base.Rule.prototype.constructor=b.Simple.Base.Rule;b.Simple.Creole=function(d){var j={};j.link="[^\\]|~\\n]*(?:(?:\\](?!\\])|~.)[^\\]|~\\n]*)*";j.linkText="[^\\]~\\n]*(?:(?:\\](?!\\])|~.)[^\\]~\\n]*)*";j.uriPrefix="\\b(?:(?:https?|ftp)://|mailto:)";j.uri=j.uriPrefix+j.link;j.rawUri=j.uriPrefix+"\\S*[^\\s!\"',.:;?]";j.interwikiPrefix="[\\w.]+:";j.interwikiLink=j.interwikiPrefix+j.link;j.img="\\{\\{((?!\\{)[^|}\\n]*(?:}(?!})[^|}\\n]*)*)"+(d&&d.strict?"":"(?:")+"\\|([^}~\\n]*((}(?!})|~.)[^}~\\n]*)*)"+(d&&d.strict?"":")?")+"}}";var h=function(g,k){if(k instanceof Function){return k(g);}k=k instanceof Array?k:[k];if(typeof k[1]=="undefined"){k[1]="";}return k[0]+g+k[1];};var f={hr:{tag:"hr",regex:/(^|\n)\s*----\s*(\n|$)/},br:{tag:"br",regex:/\\\\/},preBlock:{tag:"pre",capture:2,regex:/(^|\n)\{\{\{\n((.*\n)*?)\}\}\}(\n|$)/,replaceRegex:/^ ([ \t]*\}\}\})/gm,replaceString:"$1"},tt:{tag:"tt",regex:/\{\{\{(.*?\}\}\}+)/,capture:1,replaceRegex:/\}\}\}$/,replaceString:""},ulist:{tag:"ul",capture:0,regex:/(^|\n)([ \t]*\*[^*#].*(\n|$)([ \t]*[^\s*#].*(\n|$))*([ \t]*[*#]{2}.*(\n|$))*)+/},olist:{tag:"ol",capture:0,regex:/(^|\n)([ \t]*#[^*#].*(\n|$)([ \t]*[^\s*#].*(\n|$))*([ \t]*[*#]{2}.*(\n|$))*)+/},li:{tag:"li",capture:0,regex:/[ \t]*([*#]).+(\n[ \t]*[^*#\s].*)*(\n[ \t]*\1[*#].+)*/,replaceRegex:/(^|\n)[ \t]*[*#]/g,replaceString:"$1"},table:{tag:"table",capture:0,regex:/(^|\n)(\|.*?[ \t]*(\n|$))+/},tr:{tag:"tr",capture:2,regex:/(^|\n)(\|.*?)\|?[ \t]*(\n|$)/},th:{tag:"th",regex:/\|+=([^|]*)/,capture:1},td:{tag:"td",capture:1,regex:"\\|+([^|~\\[{]*((~(.|(?=\\n)|$)|"+"\\[\\["+j.link+"(\\|"+j.linkText+")?\\]\\]"+(d&&d.strict?"":"|"+j.img)+"|[\\[{])[^|~]*)*)"},singleLine:{regex:/.+/,capture:0},paragraph:{tag:"p",capture:0,regex:/(^|\n)([ \t]*\S.*(\n|$))+/},text:{capture:0,regex:/(^|\n)([ \t]*[^\s].*(\n|$))+/},strong:{tag:"strong",capture:1,regex:/\*\*([^*~]*((\*(?!\*)|~(.|(?=\n)|$))[^*~]*)*)(\*\*|\n|$)/},em:{tag:"em",capture:1,regex:"\\/\\/(((?!"+j.uriPrefix+")[^\\/~])*"+"(("+j.rawUri+"|\\/(?!\\/)|~(.|(?=\\n)|$))"+"((?!"+j.uriPrefix+")[^\\/~])*)*)(\\/\\/|\\n|$)"},img:{regex:j.img,build:function(m,l,k){var g=c.createElement("img");g.src=l[1];g.alt=l[2]===undefined?(k&&k.defaultImageText?k.defaultImageText:""):l[2].replace(/~(.)/g,"$1");m.appendChild(g);}},namedUri:{regex:"\\[\\[("+j.uri+")\\|("+j.linkText+")\\]\\]",build:function(m,l,g){var k=c.createElement("a");k.href=l[1];if(g&&g.isPlainUri){k.appendChild(c.createTextNode(l[2]));}else{this.apply(k,l[2],g);
}m.appendChild(k);}},namedLink:{regex:"\\[\\[("+j.link+")\\|("+j.linkText+")\\]\\]",build:function(m,l,g){var k=c.createElement("a");k.href=g&&g.linkFormat?h(l[1].replace(/~(.)/g,"$1"),g.linkFormat):l[1].replace(/~(.)/g,"$1");this.apply(k,l[2],g);m.appendChild(k);}},unnamedUri:{regex:"\\[\\[("+j.uri+")\\]\\]",build:"dummy"},unnamedLink:{regex:"\\[\\[("+j.link+")\\]\\]",build:"dummy"},unnamedInterwikiLink:{regex:"\\[\\[("+j.interwikiLink+")\\]\\]",build:"dummy"},rawUri:{regex:"("+j.rawUri+")",build:"dummy"},escapedSequence:{regex:"~("+j.rawUri+"|.)",capture:1,tag:"span",attrs:{"class":"escaped"}},escapedSymbol:{regex:/~(.)/,capture:1,tag:"span",attrs:{"class":"escaped"}}};f.unnamedUri.build=f.rawUri.build=function(l,k,g){if(!g){g={};}g.isPlainUri=true;f.namedUri.build.call(this,l,Array(k[0],k[1],k[1]),g);};f.unnamedLink.build=function(l,k,g){f.namedLink.build.call(this,l,Array(k[0],k[1],k[1]),g);};f.namedInterwikiLink={regex:"\\[\\[("+j.interwikiLink+")\\|("+j.linkText+")\\]\\]",build:function(o,n,k){var l=c.createElement("a");var g,p;if(k&&k.interwiki){g=n[1].match(/(.*?):(.*)/);p=k.interwiki[g[1]];}if(typeof p=="undefined"){if(!f.namedLink.apply){f.namedLink=new this.constructor(f.namedLink);}return f.namedLink.build.call(f.namedLink,o,n,k);}l.href=h(g[2].replace(/~(.)/g,"$1"),p);this.apply(l,n[2],k);o.appendChild(l);}};f.unnamedInterwikiLink.build=function(l,k,g){f.namedInterwikiLink.build.call(this,l,Array(k[0],k[1],k[1]),g);};f.namedUri.children=f.unnamedUri.children=f.rawUri.children=f.namedLink.children=f.unnamedLink.children=f.namedInterwikiLink.children=f.unnamedInterwikiLink.children=[f.escapedSymbol,f.img];for(var e=1;e<=6;e++){f["h"+e]={tag:"h"+e,capture:2,regex:"(^|\\n)[ \\t]*={"+e+"}[ \\t]"+"([^~]*?(~(.|(?=\\n)|$))*)[ \\t]*=*\\s*(\\n|$)"};}f.ulist.children=f.olist.children=[f.li];f.li.children=[f.ulist,f.olist];f.li.fallback=f.text;f.table.children=[f.tr];f.tr.children=[f.th,f.td];f.td.children=[f.singleLine];f.th.children=[f.singleLine];f.h1.children=f.h2.children=f.h3.children=f.h4.children=f.h5.children=f.h6.children=f.singleLine.children=f.paragraph.children=f.text.children=f.strong.children=f.em.children=[f.escapedSequence,f.strong,f.em,f.br,f.rawUri,f.namedUri,f.namedInterwikiLink,f.namedLink,f.unnamedUri,f.unnamedInterwikiLink,f.unnamedLink,f.tt,f.img];f.root={children:[f.h1,f.h2,f.h3,f.h4,f.h5,f.h6,f.hr,f.ulist,f.olist,f.preBlock,f.table],fallback:{children:[f.paragraph]}};b.Simple.Base.call(this,f,d);};b.Simple.Creole.prototype=new b.Simple.Base();b.Simple.Creole.prototype.constructor=b.Simple.Creole;a.CreoleParser=b.Simple.Creole;},"@VERSION@",{requires:["aui-base"]});AUI.add("aui-editor-html-creole",function(d){var k=d.Lang;var q="\n";var h="**";var o="//";var c="ol";var a="#";var b="p";var g="pre";var f="ul";var l="*";var m=/^h([1-6])$/i;var j=/(\r?\n\s*)$/;var e=/[^\t\n\r ]/;var n=" ";var p=d.Component.create({NAME:"domparsercreole",ATTRS:{data:{value:null,validator:k.isString}},EXTENDS:d.Base,prototype:{_endResult:null,_inPRE:false,_ulLevel:0,initializer:function(){},convert:function(u){var r=this;if(u){this.set("data",u);}else{u=this.get("data");}var t=d.config.doc.createElement("div");t.innerHTML=u;r._handle(t);var s=r._endResult.join("");r._endResult=null;return s;},_isAllWS:function(r){return r.isElementContentWhitespace||!(e.test(r.data));},_isDataAvailable:function(){var r=this;return r._endResult&&r._endResult.length;},_isIgnorable:function(t){var r=this;var s=t.nodeType;return(t.isElementContentWhitespace||s==8)||((s==3)&&r._isAllWS(t));},_isLastItemNewLine:function(t){var r=this;var s=r._endResult;return(s&&j.test(s.slice(-1)));},_handle:function(w){var C=this;var t,u,y,z,A,B,s,x,r,v;if(!k.isArray(C._endResult)){C._endResult=[];}u=w.childNodes;v=C._pushTagList;s=u.length;for(z=0;z<s;z++){A=[];B=[];x=[];r=[];t=u[z];if(C._isIgnorable(t)&&!C._inPRE){continue;}C._handleElementStart(t,A,B);C._handleStyles(t,x,r);v.call(C,A);v.call(C,x);C._handle(t);C._handleElementEnd(t,A,B);v.call(C,r.reverse());v.call(C,B);}y=w.data;C._handleData(y,w);},_handleData:function(t,s){var r=this;if(k.isValue(t)){r._endResult.push(t);}},_handleElementStart:function(v,t,s){var r=this;var u=v.tagName;var w;if(u){u=u.toLowerCase();if(u==b){r._handleParagraph(v,t,s);}else{if(u=="br"){r._handleBreak(v,t,s);}else{if(u=="a"){r._handleLink(v,t,s);}else{if(u=="strong"||u=="b"){r._handleStrong(v,t,s);}else{if(u=="em"||u=="i"){r._handleEm(v,t,s);}else{if(u=="img"){r._handleImage(v,t,s);}else{if(u==f){r._handleUnorderedList(v,t,s);}else{if(u=="li"){r._handleListItem(v,t,s);}else{if(u==c){r._handleOrderedList(v,t,s);}else{if(u=="hr"){r._handleHr(v,t,s);}else{if(u==g){r._handlePre(v,t,s);}else{if((w=m.exec(u))){r._handleHeader(v,t,s,w);}else{if(u=="th"){r._handleTableHeader(v,t,s);}else{if(u=="tr"){r._handleTableRow(v,t,s);}else{if(u=="td"){r._handleTableCell(v,t,s);}}}}}}}}}}}}}}}}},_handleElementEnd:function(v,t,s){var r=this;var u=v.tagName;if(u){u=u.toLowerCase();}if(u==b){if(!r._isLastItemNewLine()){r._endResult.push(q);}}else{if(u==f||u==c){r._ulLevel-=1;if(!r._isLastItemNewLine()){r._endResult.push(q);}}else{if(u==g){if(!r._isLastItemNewLine()){r._endResult.push(q);}r._inPRE=false;}else{if(u=="table"){s.push(q);}}}}},_handleBreak:function(u,t,s){var r=this;if(r._inPRE){t.push(q);}else{t.push("\\\\");}},_handleEm:function(t,s,r){s.push(o);r.push(o);},_handleHeader:function(v,t,s,w){var r=this;var u=new Array(parseInt(w[1],10)+1);u=u.join("=");if(r._isDataAvailable()&&!r._isLastItemNewLine()){t.push(q);}t.push(u,n);s.push(n,u,q);},_handleHr:function(u,t,s){var r=this;if(r._isDataAvailable()&&!r._isLastItemNewLine()){t.push(q);}t.push("----",q);},_handleImage:function(v,t,r){var s=v.alt;var u=v.src;t.push("{{",u);if(s){t.push("|",s);}r.push("}}");},_handleLink:function(t,s,r){var u=t.href;s.push("[[",u,"|");r.push("]]");},_handleListItem:function(x,u,t){var s=this;var r=x.parentNode;var w=r.tagName.toLowerCase();var y=(w===f)?l:a;var v=new Array(s._ulLevel+1);v=v.join(y);if(s._isDataAvailable()&&!s._isLastItemNewLine()){u.push(q);
}u.push(v,n);},_handleOrderedList:function(u,t,s){var r=this;r._ulLevel+=1;},_handleParagraph:function(u,t,s){var r=this;if(r._isDataAvailable()){var w=j.exec(r._endResult.slice(-2).join(""));var v=w?w[1].length:0;while(v++<2){t.push(q);}}s.push(q);},_handlePre:function(u,t,s){var r=this;r._inPRE=true;var v=r._endResult;var w=u.innerHTML;if(r._isDataAvailable()&&!r._isLastItemNewLine()){v.push(q);}t.push("{{{",q);s.push("}}}",q);},_handleStrong:function(t,s,r){s.push(h);r.push(h);},_handleStyles:function(s,r,u){var t=s.style;if(t){if(t.fontWeight.toLowerCase()=="bold"){r.push(h);u.push(h);}if(t.fontStyle.toLowerCase()=="italic"){r.push(o);u.push(o);}}},_handleTableCell:function(t,s,r){s.push("|");},_handleTableHeader:function(t,s,r){s.push("|","=");},_handleTableRow:function(u,t,s){var r=this;if(r._isDataAvailable()){t.push(q);}s.push("|");},_handleUnorderedList:function(u,t,s){var r=this;r._ulLevel+=1;},_pushTagList:function(w){var s=this;var u,t,v,r;u=s._endResult;v=w.length;for(t=0;t<v;t++){r=w[t];u.push(r);}}}});d.HTML2CreoleConvertor=p;},"@VERSION@",{requires:["aui-editor-base"]});AUI.add("aui-editor-creole-plugin",function(c){var g=c.Lang,h=g.isArray,b=g.isString,d=c.getClassName,l="creoleplugin",a="creole",f=/<(\/?)strong>/gi,k=/<(\/?)em>/gi,e="</span>";if(!YUI.AUI.defaults.EditorToolbar){YUI.AUI.defaults.EditorToolbar={STRINGS:{}};}var j=c.Component.create({NAME:l,NS:a,EXTENDS:c.Plugin.Base,ATTRS:{interwiki:{value:{WikiCreole:"http://www.wikicreole.org/wiki/",Wikipedia:"http://en.wikipedia.org/wiki/"}},host:{value:false},linkFormat:{value:""},strict:{value:false}},prototype:{html2creole:null,initializer:function(){var m=this;this._creole=new c.CreoleParser({forIE:c.UA.os==="windows",interwiki:this.get("interwiki"),linkFormat:this.get("linkFormat"),strict:this.get("strict")});var n=m.get("host");m.afterHostMethod("getContent",m.getCreoleCode,m);n.on("contentChange",m._contentChange,m);},_convertHTML2Creole:function(n){var m=this;if(!m.html2creole){m.html2creole=new c.HTML2CreoleConvertor({data:n});}else{m.html2creole.set("data",n);}return m.html2creole.convert();},getCreoleCode:function(){var m=this;var n=c.Do.originalRetVal;n=m._convertHTML2Creole(n);return new c.Do.AlterReturn(null,n);},getContentAsHtml:function(){var m=this;var n=m.get("host");return n.constructor.prototype.getContent.apply(n,arguments);},setContentAsCreoleCode:function(n){var m=this;var o=m.get("host");o.set("content",n);},_contentChange:function(n){var m=this;n.newVal=m._parseCreoleCode(n.newVal);n.stopImmediatePropagation();},_normalizeParsedData:function(n){var m=this;if(c.UA.gecko){n=m._normalizeParsedDataGecko(n);}else{if(c.UA.webkit){n=m._normalizeParsedDataWebKit(n);}}return n;},_normalizeParsedDataGecko:function(m){m=m.replace(f,function(q,p,o,n){if(!p){return'<span style="font-weight:bold;">';}else{return e;}});m=m.replace(k,function(q,p,o,n){if(!p){return'<span style="font-style:italic;">';}else{return e;}});return m;},_normalizeParsedDataWebKit:function(m){m=m.replace(f,"<$1b>");m=m.replace(k,"<$1i>");return m;},_parseCreoleCode:function(n){var m=this;var p=c.config.doc.createElement("div");m._creole.parse(p,n);var o=p.innerHTML;o=m._normalizeParsedData(o);return o;}}});c.namespace("Plugin").EditorCreoleCode=j;},"@VERSION@",{requires:["aui-base","editor-base","aui-editor-html-creole","aui-editor-creole-parser"]});AUI.add("aui-editor",function(a){},"@VERSION@",{skinnable:true,use:["aui-editor-base","aui-editor-tools-plugin","aui-editor-menu-plugin","aui-editor-toolbar-plugin","aui-editor-bbcode-plugin","aui-editor-creole-parser","aui-editor-creole-plugin"]});