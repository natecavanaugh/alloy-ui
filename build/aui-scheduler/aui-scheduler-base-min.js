AUI.add("aui-scheduler-base",function(ae){var S=ae.Lang,a=S.isArray,e=S.isDate,at=S.isFunction,J=S.isNumber,I=function(A){return(A instanceof ae.Scheduler);},t=function(A){return(A instanceof ae.SchedulerView);},ac=function(A){return(A instanceof ae.SchedulerEvent);},u=function(A){return(ae.SchedulerCalendar&&(A instanceof ae.SchedulerCalendar));},i=ae.DataType.DateMath,Z=ae.WidgetStdMod,X=".",p="",q=" ",s="scheduler-base",al="data-view-name",G="activeView",af="button",ay="clearfix",F="controls",an="controlsNode",am="date",aj="endDate",ak="eventClass",P="eventRecorder",az="events",aE="hd",w="header",ax="headerNode",n="helper",W="icon",k="iconNextNode",ar="iconPrevNode",aC="locale",m="name",T="nav",O="navNode",b="navigationDateFormatter",o="next",d="nextDate",aw="prev",ao="prevDate",au="radio",aD="rendered",N="scheduler",aA="startDate",E="strings",f="today",ag="todayNode",v="triggerNode",z="view",Q="viewDate",C="viewDateNode",R="viewStack",aF="views",aa="viewsNode",V="visible",B=ae.getClassName,ah=B(n,ay),j=B(W),aq=B(s,F),x=B(s,z,am),g=B(s,aE),Y=B(s,W,o),D=B(s,W,aw),aB=B(s,T),y=B(s,f),ab=B(s,z),h=B(s,z,p),r=B(s,aF),K="yui3-button-selected",ap='<div class="'+aq+'"></div>',ad='<div class="'+x+'"></div>',c='<div class="'+g+'"></div>',aG='<button type="button" class="'+[j,Y].join(q)+' yui3-button">Next</button>',ai='<button type="button" class="'+[j,D].join(q)+' yui3-button">Prev</button>',l='<div class="'+aB+'"></div>',U='<button type="button" class="'+y+' yui3-button">{today}</button>',av='<button type="button" class="'+[ab,h].join(q)+'{name}" data-view-name="{name}">{label}</button>',L='<div class="'+r+'"></div>';var M=function(){};M.ATTRS={eventClass:{valueFn:function(){return ae.SchedulerEvent;}},events:{value:[],setter:"_setEvents",validator:a}};ae.mix(M.prototype,{addEvent:function(aH){var A=this;var aI=[].concat(A.get(az));if(ae.Array.indexOf(aI,aH)===-1){aI.push(aH);A.set(az,aI);}},addEvents:function(aH){var A=this;ae.Array.each(A._normalizeEvents(aH),ae.bind(A.addEvent,A));},eachEvent:function(aI){var A=this;var aH=A.get(az);ae.Array.each(aH,aI,A);},removeEvent:function(aH){var A=this;var aI=[].concat(A.get(az));if(aI.length){ae.Array.removeItem(aI,aH);A.set(az,aI);}},removeEvents:function(aH){var A=this;ae.Array.each(A._normalizeEvents(aH),ae.bind(A.removeEvent,A));},_normalizeEvents:function(aI){var A=this;var aH=[];aI=ae.Array(aI);ae.Array.each(aI,function(aJ){if(ac(aJ)){aH.push(aJ);}else{if(u(aJ)){if(I(A)){aJ.set(N,A);}aH=aH.concat(A._normalizeEvents(aJ.get(az)));}else{aJ=new (A.get(ak))(aJ);aH.push(aJ);}}if(I(A)){aJ.set(N,A);aJ.set(ak,A.get(ak));}});return aH;},_setEvents:function(aH){var A=this;return A._normalizeEvents(aH);}});ae.SchedulerEventSupport=M;var H=ae.Component.create({NAME:s,ATTRS:{activeView:{validator:t},date:{value:new Date(),validator:e},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormatter:{value:function(aH){var A=this;return ae.DataType.Date.format(aH,{format:"%B %d, %Y",locale:A.get(aC)});},validator:at},views:{setter:"_setViews",value:[]},viewDate:{getter:"_getViewDate",readOnly:true},firstDayOfWeek:{value:0,validator:J},controlsNode:{valueFn:function(){return ae.Node.create(ap);}},viewDateNode:{valueFn:function(){return ae.Node.create(ad);}},headerNode:{valueFn:function(){return ae.Node.create(c);}},iconNextNode:{valueFn:function(){return ae.Node.create(aG);}},iconPrevNode:{valueFn:function(){return ae.Node.create(ai);}},navNode:{valueFn:function(){return ae.Node.create(l);}},todayNode:{valueFn:function(){return ae.Node.create(this._processTemplate(U));}},viewsNode:{valueFn:function(){return ae.Node.create(L);}}},HTML_PARSER:{controlsNode:X+aq,viewDateNode:X+x,headerNode:X+g,iconNextNode:X+Y,iconPrevNode:X+D,navNode:X+aB,todayNode:X+y,viewsNode:X+r},UI_ATTRS:[am,G],AUGMENTS:[ae.SchedulerEventSupport,ae.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A[R]={};A[an]=A.get(an);A[C]=A.get(C);A[w]=A.get(ax);A[k]=A.get(k);A[ar]=A.get(ar);A[O]=A.get(O);A[ag]=A.get(ag);A[aa]=A.get(aa);A.after({activeViewChange:A._afterActiveViewChange,render:A._afterRender});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ae.Array.each(A.get(az),function(aH){delete aH._filtered;});},getEventsByDay:function(aH,aI){var A=this;aH=i.safeClearTime(aH);return A._getEvents(aH,function(aJ){return i.compare(aJ.getClearStartDate(),aH)||(aI&&i.compare(aJ.getClearEndDate(),aH));});},getIntersectEvents:function(aH){var A=this;aH=i.safeClearTime(aH);return A._getEvents(aH,function(aJ){var aI=aJ.getClearStartDate();var aK=aJ.getClearEndDate();return(aJ.get(V)&&(i.compare(aH,aI)||i.compare(aH,aK)||i.between(aH,aI,aK)));});},sortEventsByDateAsc:function(aH){var A=this;aH.sort(function(aL,aJ){var aK=aL.get(aj);var aI=aJ.get(aj);var aN=aL.get(aA);var aM=aJ.get(aA);if(i.after(aN,aM)||(i.compare(aN,aM)&&i.before(aK,aI))){return 1;}else{return -1;}});},getViewByName:function(aH){var A=this;return A[R][aH];},getStrings:function(){var A=this;return A.get(E);},getString:function(aH){var A=this;return A.getStrings()[aH];},renderView:function(aH){var A=this;if(aH){aH.show();if(!aH.get(aD)){if(!A.bodyNode){A.setStdModContent(Z.BODY,p);}aH.render(A.bodyNode);}}},plotViewEvents:function(aH){var A=this;aH.plotEvents(A.get(az));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(G));},renderButtonGroup:function(){var A=this;A.buttonGroup=new ae.ButtonGroup({srcNode:A[aa],type:au,on:{selectionChange:ae.bind(A._onButtonGroupSelectionChange,A)}}).render();},syncStdContent:function(){var A=this;var aH=A.get(aF);A[O].append(A[ar]);A[O].append(A[k]);A[an].append(A[ag]);A[an].append(A[O]);A[an].append(A[C]);ae.Array.each(aH,function(aI){A[aa].append(A._createViewTriggerNode(aI));});A[w].append(A[an]);A[w].append(A[aa]);A[w].addClass(ah);A.setStdModContent(Z.HEADER,A[w].getDOM());},_afterActiveViewChange:function(aJ){var aH=this;
if(aH.get(aD)){var aI=aJ.newVal;var A=aJ.prevVal;if(A){A.hide();}aH.renderView(aI);var aK=aH.get(P);if(aK){aK.hideOverlay();}aH._uiSetDate(aH.get(am));}},_afterRender:function(aI){var A=this,aH=A.get(G);A.renderView(aH);A.renderButtonGroup();A._uiSetDate(A.get(am));A._uiSetActiveView(aH);},_bindDelegate:function(){var A=this;A[an].delegate("click",A._onClickPrevIcon,X+D,A);A[an].delegate("click",A._onClickNextIcon,X+Y,A);A[an].delegate("click",A._onClickToday,X+y,A);},_createViewTriggerNode:function(aH){var A=this;if(!aH.get(v)){var aI=aH.get(m);aH.set(v,ae.Node.create(S.sub(av,{name:aI,label:(A.getString(aI)||aI)})));}return aH.get(v);},_getEvents:function(aH,aK){var A=this;var aJ=A.get(az);var aI=[];ae.Array.each(aJ,function(aL){if(aK.apply(A,[aL])){aI.push(aL);}});A.sortEventsByDateAsc(aI);return aI;},_getViewDate:function(){var A=this,aH=A.get(am),aI=A.get(G);if(aI){aH=aI.getAdjustedViewDate(aH);}return aH;},_onClickToday:function(aH){var A=this;A.set(am,A.get(G).getToday());aH.preventDefault();},_onClickNextIcon:function(aH){var A=this;A.set(am,A.get(G).get(d));aH.preventDefault();},_onClickPrevIcon:function(aH){var A=this;A.set(am,A.get(G).get(ao));aH.preventDefault();},_onButtonGroupSelectionChange:function(aH){var A=this,aI=aH.originEvent.target.attr(al);A.set(G,A.getViewByName(aI));aH.preventDefault();},_processTemplate:function(aH){var A=this;return S.sub(aH,A.getStrings());},_setEventRecorder:function(aH){var A=this;if(aH){aH.set(N,A);aH.set(ak,A.get(ak));}},_setViews:function(aI){var A=this;var aH=[];ae.Array.each(aI,function(aJ){if(t(aJ)&&!aJ.get(aD)){aJ.set(N,A);aJ.set(ak,A.get(ak));aH.push(aJ);A[R][aJ.get(m)]=aJ;}});if(!A.get(G)){A.set(G,aI[0]);}return aH;},_uiSetActiveView:function(aJ){var A=this;if(aJ){var aI=aJ.get(m),aH=A[aa].one(X+h+aI);if(aH){A[aa].all(af).removeClass(K);aH.addClass(K);}}},_uiSetDate:function(aK){var aH=this;var aJ=aH.get(b);var A=aJ.call(aH,aK);if(aH.get(aD)){var aI=aH.get(G);if(aI){aI._uiSetDate(aK);aJ=aI.get(b);A=aJ.call(aI,aK);}aH[C].html(A);aH.syncEventsUI();}}}});ae.Scheduler=H;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource","button-group"]});