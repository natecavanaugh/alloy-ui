AUI.add("aui-scheduler-base",function(ak){var W=ak.Lang,aI=W.isString,G=W.isObject,b=W.isArray,f=W.isDate,P=W.isNumber,O=function(A){return(A instanceof ak.Scheduler);},x=function(A){return(A instanceof ak.SchedulerView);},ah=function(A){return(A instanceof ak.SchedulerEvent);},z=function(A){return(ak.SchedulerCalendar&&(A instanceof ak.SchedulerCalendar));},k=ak.DataType.DateMath,ad=ak.WidgetStdMod,aG="-",ab=".",s="",t=" ",v="scheduler-base",aq="data-view-name",M="activeView",r="boundingBox",aH="clearfix",L="controls",at="controlsNode",aw="current",aj="currentDate",af="currentDateNode",ar="date",ai="dateFormat",aC="day",ap="endDate",aJ="events",I="firstDayOfWeek",aO="hd",aF="headerNode",p="helper",Z="icon",m="iconNextNode",aB="iconPrevNode",aM="locale",h="month",o="name",X="nav",T="navNode",q="next",e="nextDate",aE="prev",au="prevDate",aN="rendered",S="scheduler",ax="srcNode",aL="startDate",J="strings",az="template",g="today",al="todayNode",B="triggerNode",E="view",aP="views",ae="viewsNode",V="week",w="year",aA="navigationDateFormat",U="eventRecorder",F=ak.getClassName,am=F(p,aH),l=F(Z),ay=F(v,L),aa=F(v,aw,ar),j=F(v,aO),ac=F(v,Z,q),H=F(v,Z,aE),aK=F(v,X),D=F(v,g),ag=F(v,E),u=F(v,aP),i=F(v,E,s),y=F(v,E,aC),a=F(v,E,h),c=F(v,E,V),ao=F(v,E,w),K=F(S,E,s),av='<div class="'+ay+'"></div>',C='<div class="'+aa+'"></div>',d='<div class="'+j+'"></div>',aQ='<a href="#" class="'+[l,ac].join(t)+'">Next</a>',an='<a href="#" class="'+[l,H].join(t)+'">Prev</a>',n='<div class="'+aK+'"></div>',Y='<a href="#" class="'+D+'">{today}</a>',aD='<a href="#" class="'+[ag,i].join(t)+'{name}" data-view-name="{name}">{label}</a>',Q='<div class="'+u+'"></div>';var R=function(){};R.ATTRS={events:{value:[],setter:"_setEvents",validator:b}};ak.mix(R.prototype,{addEvent:function(aR){var A=this;var aS=A.get(aJ);if(ak.Array.indexOf(aS,aR)>-1){ak.Array.removeItem(aS,aR);}aS.push(aR);A.set(aJ,aS);},addEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.addEvent,A));},eachEvent:function(aS){var A=this;var aR=A.get(aJ);ak.Array.each(aR,aS,A);},removeEvent:function(aR){var A=this;var aS=A.get(aJ);ak.Array.removeItem(aS,aR);A.set(aJ,aS);},removeEvents:function(aR){var A=this;ak.Array.each(A._normalizeEvents(aR),ak.bind(A.removeEvent,A));},_normalizeEvents:function(aS){var A=this;var aR=[];aS=ak.Array(aS);ak.Array.each(aS,function(aT,aU){if(ah(aT)){aR.push(aT);}else{if(z(aT)){aR=aR.concat(A._normalizeEvents(aT.get(aJ)));}else{aT=new ak.SchedulerEvent(aT);aR.push(aT);}}if(O(A)){aT.set(S,A);}});return aR;},_setEvents:function(aR){var A=this;return A._normalizeEvents(aR);}});ak.SchedulerEventSupport=R;var N=ak.Component.create({NAME:v,ATTRS:{activeView:{validator:x},eventRecorder:{setter:"_setEventRecorder"},strings:{value:{day:"Day",month:"Month",today:"Today",week:"Week",year:"Year"}},navigationDateFormat:{getter:function(aS){var A=this;var aR=A.get(M);if(aR){return aR.get(aA);}return aS;},value:"%A - %d %b %Y",validator:aI},views:{setter:"_setViews",value:[]},currentDate:{valueFn:function(){return new Date();},validator:f},firstDayOfWeek:{value:0,validator:P},controlsNode:{valueFn:function(){return ak.Node.create(av);}},currentDateNode:{valueFn:function(){return ak.Node.create(C);}},headerNode:{valueFn:function(){return ak.Node.create(d);}},iconNextNode:{valueFn:function(){return ak.Node.create(aQ);}},iconPrevNode:{valueFn:function(){return ak.Node.create(an);}},navNode:{valueFn:function(){return ak.Node.create(n);}},todayNode:{valueFn:function(){return ak.Node.create(this._processTemplate(Y));}},viewsNode:{valueFn:function(){return ak.Node.create(Q);}}},HTML_PARSER:{controlsNode:ab+ay,currentDateNode:ab+aa,headerNode:ab+j,iconNextNode:ab+ac,iconPrevNode:ab+H,navNode:ab+aK,todayNode:ab+D,viewsNode:ab+u},UI_ATTRS:[aj],AUGMENTS:[ak.SchedulerEventSupport,ak.WidgetStdMod],prototype:{viewStack:null,initializer:function(){var A=this;A.viewStack={};A.controlsNode=A.get(at);A.currentDateNode=A.get(af);A.iconNextNode=A.get(m);A.iconPrevNode=A.get(aB);A.navNode=A.get(T);A.schedulerHeaderNode=A.get(aF);A.todayNode=A.get(al);A.viewsNode=A.get(ae);A.after({render:A._afterRender,activeViewChange:A._afterActiveViewChange});},bindUI:function(){var A=this;A._bindDelegate();},syncUI:function(){var A=this;A.syncStdContent();},flushEvents:function(){var A=this;ak.Array.each(A.get(aJ),function(aR,aS){aR.eachRepeatedEvent(function(aU,aT){delete aU._filtered;});delete aR._filtered;});},getEventsByDay:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aS){return k.compare(aS.getClearStartDate(),aR);});},getIntersectEvents:function(aR){var A=this;aR=k.safeClearTime(aR);return A._getEvents(aR,function(aT){var aS=aT.getClearStartDate();var aU=aT.getClearEndDate();return(k.compare(aR,aS)||k.compare(aR,aU)||k.between(aR,aS,aU));});},sortEventsByDateAsc:function(aR){var A=this;aR.sort(function(aV,aT){var aU=aV.get(ap);var aS=aT.get(ap);var aX=aV.get(aL);var aW=aT.get(aL);if(k.after(aX,aW)||k.compare(aX,aW)&&k.before(aU,aS)){return 1;}else{return -1;}});},getViewByName:function(aR){var A=this;return A.viewStack[aR];},getStrings:function(){var A=this;return A.get(J);},getString:function(aR){var A=this;return A.getStrings()[aR];},renderView:function(aR){var A=this;if(aR){aR.show();if(!aR.get(aN)){var aS=aR.get(o);if(!A.bodyNode){A.setStdModContent(ad.BODY,s);}aR.render(A.bodyNode);}}},plotViewEvents:function(aR){var A=this;aR.plotEvents(A.get(aJ));},syncEventsUI:function(){var A=this;A.plotViewEvents(A.get(M));},_afterActiveViewChange:function(aT){var aR=this;if(aR.get(aN)){var aS=aT.newVal;var A=aT.prevVal;if(A){A.hide();}aR.renderView(aS);}},_afterRender:function(aR){var A=this;A.renderView(A.get(M));},_bindDelegate:function(){var A=this;A.viewsNode.delegate("click",A._onClickViewTrigger,ab+ag,A);A.controlsNode.delegate("click",A._onClickPrevIcon,ab+H,A);A.controlsNode.delegate("click",A._onClickNextIcon,ab+ac,A);A.controlsNode.delegate("click",A._onClickToday,ab+D,A);},_createViewTriggerNode:function(aR){var A=this;
if(!aR.get(B)){var aS=aR.get(o);aR.set(B,ak.Node.create(W.sub(aD,{name:aS,label:(A.getString(aS)||aS)})));}return aR.get(B);},_getEvents:function(aR,aT){var A=this;var aS=A.get(aJ);var aU=[];ak.Array.each(aS,function(aV,aW){if(aT.apply(A,[aV])){aU.push(aV);}else{if(aV.isRepeatableDate(aR)){var aX=aV.repeatByDate(aR);aU.push(aX);}}});A.sortEventsByDateAsc(aU);return aU;},_onClickToday:function(aR){var A=this;A.set(aj,A.get(M).getToday());aR.preventDefault();},_onClickNextIcon:function(aR){var A=this;A.set(aj,A.get(M).get(e));aR.preventDefault();},_onClickPrevIcon:function(aR){var A=this;A.set(aj,A.get(M).get(au));aR.preventDefault();},_onClickViewTrigger:function(aS){var A=this;var aT=aS.currentTarget;var aU=aT.attr(aq);var aR=A.getViewByName(aU);A.set(M,aR);aS.preventDefault();},_processTemplate:function(aR){var A=this;return W.sub(aR,A.getStrings());},_setEventRecorder:function(aR){var A=this;if(aR){aR.set(S,A);}},_setViews:function(aS){var A=this;var aR=[];ak.Array.each(aS,function(aT){if(x(aT)&&!aT.get(aN)){aT.set(S,A);aR.push(aT);A.viewStack[aT.get(o)]=aT;}});if(!A.get(M)){A.set(M,aS[0]);}return aR;},syncStdContent:function(){var A=this;var aR=A.get(aP);A.navNode.append(A.iconPrevNode);A.navNode.append(A.iconNextNode);A.controlsNode.append(A.todayNode);A.controlsNode.append(A.navNode);A.controlsNode.append(A.currentDateNode);ak.Array.each(aR,function(aS){A.viewsNode.append(A._createViewTriggerNode(aS));});A.schedulerHeaderNode.append(A.controlsNode);A.schedulerHeaderNode.append(A.viewsNode);A.schedulerHeaderNode.addClass(am);A.setStdModContent(ad.HEADER,A.schedulerHeaderNode.getDOM());},_uiSetCurrentDate:function(aV){var aS=this;var aR=aS.get(aA);var A=aS.get(aM);var aU=ak.DataType.Date.format(aV,{format:aR,locale:A});aS.currentDateNode.html(aU);if(aS.get(aN)){var aT=aS.get(M);if(aT){aT._uiSetCurrentDate(aV);}aS.syncEventsUI();}}}});ak.Scheduler=N;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-view","datasource"]});AUI.add("aui-scheduler-view",function(b9){var cq=b9.Lang,cH=cq.isObject,bY=cq.isString,aX=cq.isBoolean,aJ=cq.isNumber,bh=function(A){return A===0?0:(A<0?-1:1);},aN=function(A,cL){return Math.max(Math.abs(A),cL)*bh(A);},bL=function(A){return parseFloat(A)||0;},bN=function(cL,A){return Math.round(cL/A)*A;},at=b9.DataType.DateMath,b5=b9.WidgetStdMod,aO=at.WEEK_LENGTH,bP="scheduler-view",aI="scheduler-view-day",cd="scheduler-view-week",cA="scheduler-view-month",bK="activeView",a9="am",v="borderLeftWidth",ch="borderRightWidth",aT="boundingBox",bA="childNodes",r="children",ai="col",aA="colDaysNode",cb="colHeaderDaysNode",J="colblank",z="coldata",aL="colday",a="colgrid",bv="colmonth",X="colspan",m="coltime",cv="columnNode",aR="container",aP="content",cx="contentBox",ay="createDocumentFragment",be="currentDate",bB="data",bd="dateFormat",cn="day",V="days",F="delegateConfig",bI="disabled",Y="div",bn="division",ad="down",cf="dragNode",bX="duration",aD="endDate",a5="event",cJ="eventRecorder",t="eventWidth",b3="events",aK="first",ce="firstDayOfWeek",bb="grid",cI="hd",b7="header",bc="headerDateFormat",cE="headerTableNode",bS="height",q="HELPER",au="hidden",aS="host",aH="hourHeight",w="icon",am="isoTime",bi="labelAM",aF="labelPM",aU="left",aB="locale",ae="marker",a7="markercell",bQ="markercellNode",a0="markercellsNode",M="markers",bG="month",ba="monthContainerNode",bE="navigationDateFormat",aQ="next",bO="nextDate",cK="node",al="nomonth",av="noscroll",b6="offsetHeight",L="offsetTop",b8="offsetWidth",cm="ownerDocument",ca="pad",cs="parentEvent",S="parentNode",ap="pm",ac="prevDate",bu="proxy",aj="px",aV="rendered",b4="repeated",a1="right",bs="row",s="scheduler",aG="scheduler-event",aa="scrollable",U="shim",cc="startDate",aW="table",cy="tableColNode",j="tableDataNode",E="tableGridNode",by="tableNode",bZ="tableTimeNode",bw="tbody",e="td",bp="time",ak="timesNode",g="title",an="today",bt="top",cF="tr",B="trigger",ct="week",bC="width",bM="-",k="a",bR=".",bJ="",bD="%",W=" ",G=b9.getClassName,bo=G(bP,av),af=G(bP,aa);var aZ=b9.Component.create({NAME:bP,AUGMENTS:[b9.WidgetStdMod],ATTRS:{bodyContent:{value:bJ},height:{value:600},isoTime:{value:false,validator:aX},name:{value:bJ,validator:bY},navigationDateFormat:{value:"%A - %d %b %Y",validator:bY},nextDate:{getter:"getNextDate",readOnly:true},prevDate:{getter:"getPrevDate",readOnly:true},scheduler:{lazyAdd:false,setter:"_setScheduler"},scrollable:{value:true,validator:aX},triggerNode:{setter:b9.one},visible:{value:false}},BIND_UI_ATTRS:[aa],prototype:{initializer:function(){var A=this;A.after("render",A._afterRender);},syncUI:function(){var A=this;A.syncStdContent();},adjustCurrentDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);cM.set(be,cL);},flushViewCache:function(){},getNextDate:function(){},getPrevDate:function(){},getToday:function(){return at.clearTime(new Date());},limitDate:function(cL,cM){var A=this;if(at.after(cL,cM)){cL=at.clone(cM);}return cL;},plotEvents:function(A){},syncStdContent:function(){},syncEventUI:function(A){},_uiSetCurrentDate:function(A){},_afterRender:function(cM){var A=this;var cL=A.get(s);A.adjustCurrentDate();A._uiSetScrollable(A.get(aa));},_setScheduler:function(cM){var A=this;var cL=A.get(s);if(cL){A.removeTarget(cL);}if(cM){A.addTarget(cM);cM.after("eventsChange",b9.bind(A.flushViewCache,A));}return cM;},_uiSetScrollable:function(cM){var A=this;var cL=A.bodyNode;if(cL){cL.toggleClass(af,cM);cL.toggleClass(bo,!cM);}},_uiSetVisible:function(cL){var A=this;aZ.superclass._uiSetVisible.apply(this,arguments);if(cL&&A.get(aV)){A.adjustCurrentDate();}}}});b9.SchedulerView=aZ;var bH=cq.sub;var P=function(A,cL){return function(cN){var cM=cN.all(A);return(cM.size()>=cL)?cM:null;};},Z=G(q,au),aM=G(aG),bk=G(aG,bI),bU=G(aG,bu),R=G(s,an),ar=G(s,an,cI),C=G(bP,z),c=G(bP,a),ci=G(bP,bb),cj=G(bP,bb,aR),bm=G(bP,ae,bn),cl=G(bP,a7),N=G(bP,M),bz=G(bP,aW),cp=G(bP,cn,b7,aW),u=G(bP,cn,b7,cn),bl=G(bP,cn,b7,cn,ca,a1),bW=G(bP,cn,b7,cn,aK),a4=G(bP,cn,b7,ai),cC=G(bP,aW,ai),aE=G(bP,aW,ai,U),Q=G(bP,aW,J),I=G(bP,aW,aL),n=G(bP,aW,aL,b7),cu=G(bP,aW,m),br=G(bP,aW,bp),ag='<div class="'+cl+'">'+'<div class="'+bm+'"></div>'+"</div>",ax='<table cellspacing="0" cellpadding="0" class="'+bz+'">'+"<tbody>"+'<tr class="'+c+'" height="1">'+'<td height="0" class="'+[cC,Q].join(W)+'"></td>'+'<td class="'+cj+'" colspan="1">'+'<div class="'+ci+'">'+'<div class="'+N+'"></div>'+"</div>"+"</td>"+"</tr>"+'<tr class="'+C+'">'+'<td class="'+[cC,cu].join(W)+'"></td>'+"</tr>"+"</tbody>"+"</table>",bg='<td class="'+[cC,I].join(W)+'">'+'<div class="'+aE+'"></div>'+"</td>",i='<div class="'+br+'">{hour}</div>',az='<table cellspacing="0" cellpadding="0" class="'+cp+'">'+"<tbody>"+'<tr class="'+a4+'"></tr>'+"</tbody>"+"</table>",bj='<th class="'+u+'"><a href="#">&nbsp;</a></th>',aw='<td class="'+[u,bW].join(W)+'"></td>',x='<th class="'+[u,bl].join(W)+'">&nbsp;</th>';
var cD=b9.Component.create({NAME:aI,ATTRS:{bodyContent:{value:bJ},days:{value:1,validator:aJ},delegateConfig:{value:{},setter:function(cL){var A=this;return b9.merge({dragConfig:{useShim:false},bubbleTargets:A,container:A.get(aT),nodes:bR+aM,invalid:"input, select, button, a, textarea, "+bR+bk},cL||{});},validator:cH},headerDateFormat:{value:"%a %d/%m",validator:bY},name:{value:cn},hourHeight:{value:52,validator:aJ},eventWidth:{value:95,validator:aJ},headerTableNode:{valueFn:function(){return b9.Node.create(az);}},tableNode:{valueFn:function(){return b9.Node.create(ax);}},colDaysNode:{valueFn:"_valueColDaysNode"},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},markercellsNode:{valueFn:"_valueMarkercellsNode"},timesNode:{valueFn:"_valueTimesNode"}},HTML_PARSER:{colHeaderDaysNode:P(bR+u,2),colDaysNode:P(bR+I,1),markercellsNode:P(bR+cl,24),timesNode:P(bR+br,24),headerTableNode:bR+cp,tableNode:bR+bz},EXTENDS:b9.SchedulerView,prototype:{initializer:function(){var A=this;A.colDaysNode=A.get(aA);A.colHeaderDaysNode=A.get(cb);A.headerTableNode=A.get(cE);A.markercellsNode=A.get(a0);A.tableNode=A.get(by);A.timesNode=A.get(ak);A.colShimNodes=A.colDaysNode.all(bR+aE);A.colDataNode=A.tableNode.one(bR+C);A.colTimeNode=A.tableNode.one(bR+cu);A.dayHeaderColNode=A.headerTableNode.one(bR+a4);A.gridContainer=A.tableNode.one(bR+cj);A.markersNode=A.tableNode.one(bR+N);A.activeColumn=null;},renderUI:function(){var A=this;A.colTimeNode.setContent(A.timesNode);A.markersNode.setContent(A.markercellsNode);A.colDaysNode.appendTo(A.colDataNode);A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);},bindUI:function(){var A=this;A.headerTableNode.delegate("click",b9.bind(A._onClickDaysHeader,A),bR+u);A.colDataNode.delegate("mousedown",b9.bind(A._onMouseDownTableCol,A),bR+cC);A.colDataNode.delegate("mouseup",b9.bind(A._onMouseUpTableCol,A),bR+cC);A.colDataNode.delegate("mousemove",b9.bind(A._onMouseMoveTableCol,A),bR+cC);A.on("drag:end",A._onEventDragEnd);A.on("drag:start",A._onEventDragStart);A.on("drag:tickAlignY",A._dragTickAlignY);A.after("drag:align",A._afterDragAlign);},syncUI:function(){var A=this;cD.superclass.syncUI.apply(this,arguments);A.gridContainer.attr(X,A.get(V));A._setupDragDrop();},syncStdContent:function(){var A=this;A.setStdModContent(b5.BODY,A.tableNode.getDOM());A.setStdModContent(b5.HEADER,A.headerTableNode.getDOM());},calculateTopByDate:function(cN){var cL=this;var A=cL.get(aH);var cM=cN.getHours();var cO=cN.getMinutes();var cP=cN.getSeconds();return((cM*60)+cO+(cP/60))*(A/60);},calculateHoursByTop:function(cO){var cL=this;var A=cL.get(aH);var cQ=bL((cO/A).toFixed(2));var cP=0;var cN=Math.floor((cQ*100)%100*0.6);var cM=Math.floor(cQ);return[cM,cN,cP];},getNextDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);return at.add(cL,at.DAY,1);},getPrevDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);return at.subtract(cL,at.DAY,1);},getColumnByDate:function(cM){var A=this;var cN=A.get(s);var cL=at.safeClearTime(cN.get(be));var cO=at.getDayOffset(at.safeClearTime(cM),cL);return A.colDaysNode.item(cO);},getDateByColumn:function(cM){var A=this;var cN=A.get(s);var cL=at.safeClearTime(cN.get(be));return at.add(cL,at.DAY,cM);},plotEvents:function(cM){var A=this;var cL=A.get(s);A.colShimNodes.each(function(cQ,cP){var cO=A.getDateByColumn(cP);var cN=cL.getEventsByDay(cO);cQ.empty();b9.Array.each(cN,function(cR,cS){if(!cR.isDayOverlapEvent()){cQ.append(cR.get(cK));cR.set(cv,cQ.get(S));A.syncEventTopUI(cR);A.syncEventHeightUI(cR);}});A.syncEventsIntersectionUI(cN);});},syncColumnsUI:function(){var A=this;A.colDaysNode.each(function(cN,cM){var cL=A.getDateByColumn(cM);cN.toggleClass(R,at.isToday(cL));});},syncDaysHeaderUI:function(){var cM=this;var cO=cM.get(s);var cN=cO.get(be);var cL=cM.get(bc);var A=cM.get(aB);cM.colHeaderDaysNode.all(k).each(function(cR,cQ){var cP=at.add(cN,at.DAY,cQ);var cS=b9.DataType.Date.format(cP,{format:cL,locale:A});cR.toggleClass(ar,at.isToday(cP));cR.html(cS);});},syncEventsIntersectionUI:function(cL){var A=this;var cM=A.get(s);var cN=A.get(t);cM.flushEvents();b9.Array.each(cL,function(cP,cQ){var cS=A.findEventIntersections(cP,cL);var cR=cS.length;var cO=(cN/cR);b9.Array.each(cS,function(cU,cV){var cT=cU.get(cK);var cX=cO*cV;var cW=cO*1.7;if(cV===(cR-1)){cW=cN-cX;}cT.setStyle(bC,cW+bD);cT.setStyle(aU,cX+bD);var cY=cT.get(S);if(cY){cY.insert(cT,cV);}cU._filtered=true;});});},syncEventHeightUI:function(cM){var cL=this;var A=cL.get(aH);var cO=cL.calculateTopByDate(cM.get(cc));var cN=cL.calculateTopByDate(cM.get(aD));cM.get(cK).set(b6,Math.max(cN-cO,A/2));},syncEventRecorderUI:function(cN){var A=this;var cM=A.get(s);var cO=cM.get(cJ);var cL=cO.get(cK);if(cN&&!cL.inDoc()){cN.append(cL);}A.syncEventTopUI(cO);A.syncEventHeightUI(cO);},syncEventTopUI:function(cM){var cL=this;var A=cM.get(cK);var cN=cL.calculateTopByDate(cM.get(cc));A.setStyle(bt,cN+aj);},findEventIntersections:function(cL,cM){var A=this;var cN=[];b9.Array.each(cM,function(cP,cO){if(!cL._filtered&&!cP.isDayOverlapEvent()&&cL.intersectHours(cP)){cN.push(cP);}});return cN;},_createEvents:function(){var A=this;var cL=function(cM,cN){A.publish(cM,{defaultFn:cN,queuable:false,emitFacade:true,bubbles:true});};},_afterDragAlign:function(cL){var A=this;A.delegate.dd.actXY[0]=null;},_dragTickAlignX:function(cO){var A=this;var cQ=A.proxyEvt;var cM=A.colDaysNode.indexOf(cO);var cL=A.getDateByColumn(cM);var cP=at.clone(cL);var cN=at.clone(cL);at.copyHours(cN,cQ.get(aD));at.copyHours(cP,cQ.get(cc));cQ.set(aD,cN);cQ.set(cc,cP);cO.append(cQ.get(cK));},_dragTickAlignY:function(cO){var cL=this;var A=cO.target.get(aS);var cR=cL.proxyEvt;var cN=A.get(cK).getData(aG);var cQ=at.clone(cR.get(cc));var cP=cL.calculateHoursByTop(bL(A.get(cf).getComputedStyle(bt)));cL._setTickedHours(cQ,cP);var cM=at.clone(cQ);cR.set(aD,at.add(cM,at.MINUTES,cL._currentEvtDuration));cR.set(cc,cQ);cR.syncNodeTitleUI();},_getXYDelta:function(cL){var A=this;var cN=cL.currentTarget;var cM=cN.getXY(),cO=[cL.pageX,cL.pageY];return b9.Array.map(cM,function(cQ,cP){return(cO[cP]-cQ);
});},_getTickY:function(){var A=this;return bN(Math.ceil(A.get(aH)/2),10);},_getColumnRefWidth:function(){var A=this;var cL=A.colDaysNode.item(0);return bL(cL.get(b8))-bL(cL.getStyle(ch))-bL(cL.getStyle(v));},_setupDragDrop:function(){var cL=this;var cM=cL.get(aT);if(!cL.proxyEvt){var cN=cL.get(s);cL.proxyEvt=new b9.SchedulerEvent({scheduler:cN});cL.proxyEvt.removeTarget(cN);cL.proxyEvt.get(cK).addClass(bU).hide();}if(!cL.delegate){cL.delegate=new b9.DD.Delegate(cL.get(F));}var A=cL.delegate.dd;var cO=cL.get(aH)/2;A.unplug(b9.Plugin.DDConstrained);A.unplug(b9.Plugin.DDNodeScroll);A.plug(b9.Plugin.DDConstrained,{bubbleTargets:cL,constrain:cL.bodyNode,stickY:true,tickY:cO});A.plug(b9.Plugin.DDNodeScroll,{node:cL.bodyNode,scrollDelay:150});},_uiSetCurrentDate:function(cL){var A=this;A.syncColumnsUI();A.syncDaysHeaderUI();},_onClickDaysHeader:function(cN){var A=this;var cM=A.get(s);if(cN.target.test(k)){var cO=cM.getViewByName(cn);var cL=A.colHeaderDaysNode.indexOf(cN.currentTarget)-1;if(cO){cM.set(be,A.getDateByColumn(cL));cM.set(bK,cO);}}cN.preventDefault();},_onEventDragEnd:function(cP){var cL=this;var cN=cL.get(s);var cM=cL.get(aT);var A=cL.delegate.dd;var cQ=cL.proxyEvt;var cO=A.get(cK).getData(aG);A.get(cK).show();cQ.get(cK).hide();cM.selectable();cO.copyDates(cQ);cN.syncEventsUI();},_onEventDragStart:function(cP){var cL=this;var cN=cL.get(aT);var A=cL.delegate.dd;var cQ=cL.proxyEvt;var cO=A.get(cK).getData(aG);if(cO){var cM=cO.get(cv);var cR=cQ.get(cK);A.set(cf,cR);cM.append(cR);cQ.copyPropagateAttrValues(cO);cL.syncEventTopUI(cQ);cL.syncEventHeightUI(cQ);cR.show();cL._currentEvtDuration=cO.getMinutesDuration();}A.get(cK).hide();cN.unselectable();},_onMouseDownTableCol:function(cN){var A=this;var cM=A.get(s);var cO=cM.get(cJ);if(cO&&!cM.get(bI)){cO.hideOverlay();if(cN.target.test(bR+aE)){var cL=A.colDaysNode.indexOf(cN.currentTarget);A.dragXY=A.startXY=A._getXYDelta(cN);A.ddStartDate=A.getDateByColumn(cL);A.ddEndDate=at.clone(A.ddStartDate);A._setTickedHours(A.ddStartDate,A.calculateHoursByTop(A.startXY[1]));A.ddMaxDate=at.clone(A.ddStartDate);A.ddMaxDate.setHours(23,59,59);cO.set(cc,A.ddStartDate);cO.set(aD,A.limitDate(cO.get(aD),A.ddMaxDate));cN.halt();}}},_onMouseMoveTableCol:function(cO){var A=this;var cN=A.get(s);var cR=cN.get(cJ);if(A.activeColumn!==cO.currentTarget){A.activeColumn=cO.currentTarget;cO.pageX=100;A._dragTickAlignX(A.activeColumn);}var cP=A.ddStartDate;if(cP){A.dragXY=A._getXYDelta(cO);A._setTickedHours(A.ddEndDate,A.calculateHoursByTop(A.dragXY[1]));var cQ=at.getMinutesOffset(A.ddEndDate,cP);if((A.dragXY[1]-A.startXY[1])>0){cQ=aN(cQ,cR.get(bX));}var cL=A.limitDate(at.add(cP,at.MINUTES,cQ),A.ddMaxDate);if(cQ>0){cR.set(aD,cL);}else{var cM=cR.get(aD);cR.set(cc,cL);cR.set(aD,cM);}A.syncEventRecorderUI(cO.currentTarget);}},_onMouseUpTableCol:function(cM){var A=this;var cL=A.get(s);var cN=cL.get(cJ);if(cN&&!cL.get(bI)){if(A.ddStartDate){A.syncEventRecorderUI(cM.currentTarget);cN.showOverlay();}A.ddEndDate=null;A.ddStartDate=null;}},_setTickedHours:function(cL,cM){var A=this;cL.setHours(cM[0],bN(cM[1],A._getTickY()),cM[2]);},_valueColDaysNode:function(){var A=this;var cM=A.get(V);var cL=[];while(cM--){cL.push(bg);}return b9.NodeList.create(cL.join(bJ));},_valueColHeaderDaysNode:function(){var A=this;var cM=A.get(V);var cL=[];cL.push(aw);while(cM--){cL.push(bj);}cL.push(x);return b9.NodeList.create(cL.join(bJ));},_valueMarkercellsNode:function(){var A=this;var cL=[],cM;for(cM=0;cM<=23;cM++){cL.push(ag);}return b9.NodeList.create(cL.join(bJ));},_valueTimesNode:function(){var A=this;var cN=A.get(am);var cM=[],cL;for(cL=0;cL<=23;cL++){cM.push(bH(i,{hour:cN?at.toIsoTimeString(cL):at.toUsTimeString(cL,false,true)}));}return b9.NodeList.create(cM.join(bJ));}}});b9.SchedulerDayView=cD;var ao=b9.Component.create({NAME:cd,ATTRS:{bodyContent:{value:bJ},days:{value:7},name:{value:ct}},EXTENDS:b9.SchedulerDayView,prototype:{adjustCurrentDate:function(){var A=this;var cN=A.get(s);var cL=cN.get(be);var cM=cN.get(ce);cN.set(be,at.getFirstDayOfWeek(cL,cM));},getNextDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);var cN=A._firstDayOfWeek(cL);return at.add(cN,at.WEEK,1);},getPrevDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);var cN=A._firstDayOfWeek(cL);return at.subtract(cN,at.WEEK,1);},getToday:function(){var A=this;var cL=ao.superclass.getToday.apply(this,arguments);return A._firstDayOfWeek(cL);},_firstDayOfWeek:function(cM){var A=this;var cN=A.get(s);var cL=cN.get(ce);return at.getFirstDayOfWeek(cM,cL);}}});b9.SchedulerWeekView=ao;var f=G(w),l=G(w,"arrowstop-1-l"),cw=G(w,"arrowstop-1-r"),b2=G(bP,bG,a),o=G(bP,bG,a,aK),b=G(bP,bG,a,an),h=G(bP,bG,aR),a6=G(bP,bG,b7,ai),y=G(bP,bG,b7,cn),cz=G(bP,bG,b7,aW),b1=G(bP,bG,bs),aq=G(bP,bG,bs,aR),cG=G(bP,aW,bv,b7),bF=G(bP,bG,aW,bB),b0=G(bP,bG,aW,bB,ai),cg=G(bP,bG,aW,bB,ai,aK),a3=G(bP,bG,aW,bB,ai,al),aY=G(bP,bG,aW,bB,ai,g),cB=G(bP,bG,aW,bB,ai,g,ad),ah=G(bP,bG,aW,bB,ai,g,aK),D=G(bP,bG,aW,bB,ai,g,aQ),T=G(bP,bG,aW,bB,ai,g,an),bq=G(bP,bG,aW,bB,a5),d=G(bP,bG,aW,bB,a5,aU),p=G(bP,bG,aW,bB,a5,b4),bT=G(bP,bG,aW,bB,a5,a1),a2=G(bP,bG,aW,bB,aK),bf=G(bP,bG,aW,bb),cr=G(bP,bG,aW,bb,aK),H='<table cellspacing="0" cellpadding="0" class="'+cz+'">'+"<tbody>"+'<tr class="'+a6+'"></tr>'+"</tbody>"+"</table>",O='<th class="'+y+'"><div>&nbsp;</div></th>',co='<div class="'+h+'">'+'<div class="'+aq+'">'+'<div class="'+b1+'" style="top: 0; height: 16.6667%;"></div>'+'<div class="'+b1+'" style="top: 16.6667%; height: 16.6667%;"></div>'+'<div class="'+b1+'" style="top: 33.3333%; height: 16.6667%;"></div>'+'<div class="'+b1+'" style="top: 50%; height: 16.6667%;"></div>'+'<div class="'+b1+'" style="top: 66.6667%; height: 16.6667%;"></div>'+'<div class="'+b1+'" style="top: 83.3333%; height: 16.6667%;"></div>'+"</div>"+"</div>",bx='<table cellspacing="0" cellpadding="0" class="'+bf+'">'+"<tbody>"+"<tr>"+'<td class="'+[b2,o].join(W)+'">&nbsp;</td>'+'<td class="'+b2+'">&nbsp;</td>'+'<td class="'+b2+'">&nbsp;</td>'+'<td class="'+b2+'">&nbsp;</td>'+'<td class="'+b2+'">&nbsp;</td>'+'<td class="'+b2+'">&nbsp;</td>'+'<td class="'+b2+'">&nbsp;</td>'+"</tr>"+"</tbody>"+"</table>",bV='<table cellspacing="0" cellpadding="0" class="'+bF+'">'+"<tbody></tbody>"+"</table>",ck="<tr></tr>",a8='<td class="'+b0+'"><div></div></td>',ab='<span class="'+[f,l].join(W)+'"></span>',K='<span class="'+[f,cw].join(W)+'"></span>';
var aC=b9.Component.create({NAME:cA,ATTRS:{bodyContent:{value:bJ},name:{value:bG},headerDateFormat:{value:"%a"},navigationDateFormat:{value:"%b %Y"},scrollable:{value:false},monthContainerNode:{valueFn:function(){return b9.Node.create(co);}},headerTableNode:{valueFn:function(){return b9.Node.create(H);}},colHeaderDaysNode:{valueFn:"_valueColHeaderDaysNode"},tableGridNode:{valueFn:"_valueTableGridNode"}},HTML_PARSER:{tableGridNode:P(bR+bf,7),colHeaderDaysNode:P(bR+y,7),monthContainerNode:bR+h,headerTableNode:bR+cz},EXTENDS:b9.SchedulerView,prototype:{evtDateStack:null,evtDataTableStack:null,initializer:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};A.colHeaderDaysNode=A.get(cb);A.headerTableNode=A.get(cE);A.monthContainerNode=A.get(ba);A.tableGridNode=A.get(E);A.dayHeaderColNode=A.headerTableNode.one(bR+a6);A.monthRows=A.monthContainerNode.all(bR+b1);A.tableGridCols=A.tableGridNode.all(e);},renderUI:function(){var A=this;A.colHeaderDaysNode.appendTo(A.dayHeaderColNode);A.monthRows.each(function(cN,cM){var cL=A.tableGridNode.item(cM);cN.append(cL.toggleClass(cr,(cM===0)));});},buildEventsTable:function(cL,cQ){var cW=this;var cT=5;var cN=at.clearTime(cW._findCurrentMonthEnd());var cV=at.clearTime(cW._findCurrentMonthStart());var cS=String(cV.getTime()).concat(cL.getTime()).concat(cQ.getTime());var cR=cW.evtDataTableStack[cS];if(!cR){cR=b9.Node.create(bV);var cU=cR.one(bw);var cO=b9.Node.create(ck);cW.loopDates(cL,cQ,function(cY,cX){var cZ=b9.Node.create(a8);cZ.addClass(aY).toggleClass(ah,(cX===0)).toggleClass(T,at.isToday(cY)).toggleClass(D,at.isToday(at.subtract(cY,at.DAY,1))).toggleClass(cB,at.isToday(at.subtract(cY,at.WEEK,1)));if(at.before(cY,cV)||at.after(cY,cN)){cZ.addClass(a3);}cO.append(cZ.setContent(cY.getDate()));});cU.append(cO);var A;for(A=0;A<cT;A++){var cP=0;var cM=b9.Node.create(ck);cW.loopDates(cL,cQ,function(c2,c0){if(cP<=c0){var c1=cW.getIntersectEvents(c2),cY=c1[A];var c3=b9.Node.create(a8);if(cY){var cX=c3.one(Y);var cZ=cW._getEvtSplitInfo(cY,cL,cQ);c3.attr(X,cZ.colspan);cX.addClass(bq).setContent(cW._getEvtLabel(cY));if(cZ.left){cX.addClass(d).prepend(ab);}if(cZ.right){cX.addClass(bT).append(K);}if(cY.get(cs)){cX.addClass(p);}cP+=cZ.colspan;}else{cP++;}cM.append(c3);}});cU.append(cM);}cW.evtDataTableStack[cS]=cR;}return cR;},flushViewCache:function(){var A=this;A.evtDateStack={};A.evtDataTableStack={};},getIntersectEvents:function(cL){var A=this;var cN=A.get(s);var cM=String(cL.getTime());if(!A.evtDateStack[cM]){A.evtDateStack[cM]=cN.getIntersectEvents(cL);}return A.evtDateStack[cM];},loopDates:function(A,cN,cQ,cR,cP){var cS=this;var cL=at.clone(A);var cM=cN.getTime(),cO;for(cO=0;cL.getTime()<=cM;cO++){cQ.apply(cS,[cL,cO]);cL=at.add(cL,(cR||at.DAY),(cP||1));}},plotEvents:function(){var cL=this;var cM=cL._findCurrentMonthStart();var A=at.safeClearTime(cL._findFirstDayOfWeek(cM));cL.bodyNode.all(bR+bF).remove();cL.monthRows.each(function(cQ,cO){var cN=at.add(A,at.WEEK,cO);var cR=at.add(cN,at.DAY,aO-1);var cP=cL.buildEventsTable(cN,cR);if(cO===0){cP.addClass(a2);}cQ.append(cP);});},syncStdContent:function(){var A=this;A.setStdModContent(b5.BODY,A.monthContainerNode.getDOM());A.setStdModContent(b5.HEADER,A.headerTableNode.getDOM());},syncGridUI:function(){var cS=this;var cM=cS.getToday();var cL=cS.get(s);cS.tableGridCols.removeClass(b);if(at.isSameMonth(cM,cL.get(be))){var A=cL.get(ce);var cO=cS._findCurrentMonthStart();var cQ=cS._findFirstDayOfWeek(cM);var cN=at.getWeekNumber(cM,A)-at.getWeekNumber(cO,A);var cR=(cM.getDate()-cQ.getDate());var cP=cS.tableGridNode.item(cN).all(e).item(cR);if(cP){cP.addClass(b);}}},adjustCurrentDate:function(){var A=this;var cL=A.get(s);cL.set(be,A._findCurrentMonthStart());},getNextDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);return at.add(cL,at.MONTH,1);},getPrevDate:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);return at.subtract(cL,at.MONTH,1);},syncDaysHeaderUI:function(){var cM=this;var cP=cM.get(s);var cN=cP.get(be);var cL=cM.get(bc);var A=cM.get(aB);var cO=cM._findFirstDayOfWeek(cN);cM.colHeaderDaysNode.all(Y).each(function(cS,cR){var cQ=at.add(cO,at.DAY,cR);var cT=b9.DataType.Date.format(cQ,{format:cL,locale:A});cS.html(cT);});},_findCurrentMonthEnd:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);return at.findMonthEnd(cL);},_findCurrentMonthStart:function(){var A=this;var cM=A.get(s);var cL=cM.get(be);return at.findMonthStart(cL);},_findFirstDayOfWeek:function(cM){var A=this;var cN=A.get(s);var cL=cN.get(ce);return at.getFirstDayOfWeek(cM,cL);},_getEvtLabel:function(cM){var cL=this;var cN=cM.get(aD);var A=cM.get(cc);return[A.getHours(),bM,cN.getHours(),W,cM.get(aP)].join(bJ);},_getEvtSplitInfo:function(cR,A,cP){var cS=this;var cL=cR.getClearStartDate();var cQ=cR.getClearEndDate();var cO=cR.getDaysDuration();var cN={};var cM=1;if(at.after(cL,A)){cM=Math.min(cO,Math.abs(at.getDayOffset(cP,cL))+1);if(cM>1){cN.right=true;}}else{cM=Math.abs(at.getDayOffset(cQ,A)+1);if(cM>1){cN.left=true;}}cN.colspan=Math.min(cM,aO);if(cM>=aO){cN.right=true;cN.left=true;}return cN;},_uiSetCurrentDate:function(cL){var A=this;A.syncDaysHeaderUI();A.syncGridUI();},_valueColHeaderDaysNode:function(){var A=this;return A._valueNodeList(aO,O);},_valueTableGridNode:function(){var A=this;return A._valueNodeList(aO,bx);},_valueNodeList:function(cN,cM){var A=this;var cL=[];while(cN--){cL.push(cM);}return b9.NodeList.create(cL.join(bJ));}}});b9.SchedulerMonthView=aC;},"@VERSION@",{skinnable:true,requires:["aui-scheduler-event","aui-calendar","aui-button-item","dd-drag","dd-delegate","dd-drop","dd-constrain"]});AUI.add("aui-scheduler-event",function(aF){var am=aF.Lang,bh=am.isString,h=am.isDate,a5=am.isFunction,P=am.isObject,a8=am.isBoolean,aa=am.isNumber,aW=aF.ColorUtil,n=aF.DataType.DateMath,a2=aF.cached(function(A){return A.substring(0,1).toUpperCase()+A.substring(1);}),bd="-",z="&ndash;",av=".",u="",v=" ",r="_",aJ="_propagateSet",U="activeView",aD="borderStyle",bp="borderWidth",Q="Change",a1="color",aS="colorBrightnessFactor",bb="colorSaturationFactor",aB="content",ag="contentNode",B="disabled",aZ="duration",aM="endDate",bi="events",aq="hidden",ap="icon",Y="icons",a0="id",aU="isoTime",bo="locale",s="node",k="overlay",aH="parentEvent",bs="recorder",aK="repeat",bg="repeated",a6="repeater",T="repeatedEvents",af="scheduler",at="scheduler-event",au="scheduler-event-recorder",bk="startDate",a4="template",aR="title",g="titleDateFormat",N="titleNode",an="visible",f="%H:%M",a3="%I:%M",L=aF.getClassName,o=L(ap),w=L(at),aN=L(at,aB),G=L(at,aq),bf=L(at,B),ao=L(at,bs),ax=L(at,bg),al=L(at,a6),I=L(at,aR),bn=L(at,Y);
CSS_SCHEDULER_EVENT_ICON_DISABLED=L(at,ap,B),CSS_SCHEDULER_EVENT_ICON_REPEATED=L(at,ap,bg),CSS_SCHEDULER_EVENT_ICON_REPEATER=L(at,ap,a6);var V=aF.Component.create({NAME:at,ATTRS:{borderStyle:{value:"solid",validator:bh},borderWidth:{value:"1px",validator:bh},colorBrightnessFactor:{value:0.75,validator:aa},colorSaturationFactor:{value:1.5,validator:aa},content:{value:"(no title)",validator:bh},color:{lazyAdd:false,setter:"_setColor",value:"#D96666",validator:bh},titleDateFormat:{getter:"_getTitleDateFormat",validator:bh},endDate:{valueFn:function(){var A=n.clone(this.get(bk));A.setHours(A.getHours()+1);return A;},validator:h},columnNode:{setter:aF.one},disabled:{value:false,validator:a8},node:{valueFn:function(){return aF.Node.create(this.EVENT_NODE_TEMPLATE).setData(at,this);},setter:aF.one},parentEvent:{},repeat:{setter:"_setRepeat"},scheduler:{lazyAdd:false,setter:"_setScheduler"},startDate:{valueFn:function(){return new Date();},validator:h},visible:{value:true,validator:a8}},EXTENDS:aF.Base,PROPAGATE_ATTRS:[bk,aM,aB,a1,aS,bb,aD,bp,g,an,B],prototype:{EVENT_NODE_TEMPLATE:'<div class="'+w+'">'+'<div class="'+I+'"></div>'+'<div class="'+aN+'"></div>'+'<div class="'+bn+'">'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_REPEATED].join(v)+'"></span>'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_REPEATER].join(v)+'"></span>'+'<span class="'+[o,CSS_SCHEDULER_EVENT_ICON_DISABLED].join(v)+'"></span>'+"</div>"+"</div>",eventStack:null,initializer:function(){var A=this;var bu=A.get(s);A.eventStack={};A.nodeStack={};aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(bv){A.after(bv+Q,A._propagateAttrChange);});A._bindUIAttrs();A.contentNode=bu.one(av+aN);A.titleNode=bu.one(av+I);A.syncNodeUI(true);},destroy:function(){var A=this;A.eachRepeatedEvent(function(bu,bv){bu.destroy();});A.eventStack={};A.get(s).remove(true);},copyDates:function(bu){var A=this;A.set(aM,n.clone(bu.get(aM)));A.set(bk,n.clone(bu.get(bk)));},copyPropagateAttrValues:function(bu,bv){var A=this;A.copyDates(bu);aF.Array.each(aF.SchedulerEvent.PROPAGATE_ATTRS,function(bw){if(!(bw in (bv||{}))){var bx=bu.get(bw);if(!P(bx)){A.set(bw,bx);}}});},getBorderColor:function(){var A=this;return A.borderColorRGB.hex;},getDaysDuration:function(){var A=this;return n.getDayOffset(A.get(aM),A.get(bk));},getHoursDuration:function(){var A=this;return n.getHoursOffset(A.get(aM),A.get(bk));},getMinutesDuration:function(){var A=this;return n.getMinutesOffset(A.get(aM),A.get(bk));},getSecondsDuration:function(){var A=this;return n.getSecondsOffset(A.get(aM),A.get(bk));},sameEndDate:function(bu){var A=this;return n.compare(A.get(aM),bu.get(aM));},sameStartDate:function(bu){var A=this;return n.compare(A.get(bk),bu.get(bk));},isAfter:function(bw){var bv=this;var bu=bv.get(bk);var A=bw.get(bk);return n.after(bu,A);},isBefore:function(bw){var bv=this;var bu=bv.get(bk);var A=bw.get(bk);return n.before(bu,A);},repeatByDate:function(bv){var A=this;var bw=A.uidByDate(bv);if(!A.eventStack[bw]){var bu=n.clone(bv);var bx=n.clone(bv);n.copyHours(bu,A.get(bk));n.copyHours(bx,A.get(aM));var by=new aF.SchedulerEvent({endDate:bx,parentEvent:A,scheduler:A.get(af),startDate:bu});by.copyPropagateAttrValues(A);A.eventStack[bw]=by;}return A.eventStack[bw];},intersects:function(bw){var bv=this;var bx=bv.get(aM);var bu=bv.get(bk);var A=bw.get(bk);return(bv.sameStartDate(bw)||n.between(A,bu,bx));},intersectHours:function(bv){var bu=this;var bx=bu.get(aM);var A=bu.get(bk);var bw=n.clone(A);n.copyHours(bw,bv.get(bk));return(n.compare(A,bw)||n.between(bw,A,bx));},isDayOverlapEvent:function(){var A=this;return n.isDayOverlap(A.get(bk),A.get(aM));},isRepeatableDate:function(bu){var A=this;var bv=A.get(aK);return(bv&&bv.validate(A,bu));},getClearEndDate:function(){var A=this;return n.safeClearTime(A.get(aM));},getClearStartDate:function(){var A=this;return n.safeClearTime(A.get(bk));},uidByDate:function(bu){var A=this;bu=h(bu)?n.safeClearTime(bu):A.getClearStartDate();return[at,bu.getTime()].join(r);},setContent:function(bv,bu){var A=this;A._setContent(ag,bv,bu);},setTitle:function(bv,bu){var A=this;A._setContent(N,bv,bu);},syncNodeUI:function(bu){var A=this;A._syncUIAttrs();A.syncNodeColorUI(bu);A.syncNodeTitleUI(bu);A.syncNodeContentUI(bu);},syncNodeColorUI:function(bu){var A=this;var bv=A.get(s);var bw=A.getBorderColor();if(bv){bv.setStyles({borderWidth:A.get(bp),borderColor:bw,backgroundColor:A.get(a1),borderStyle:A.get(aD)});}if(A.titleNode){A.titleNode.setStyles({backgroundColor:bw});}if(bu){A.eachRepeatedEvent(function(bx,by){bx.syncNodeColorUI();});}},syncNodeContentUI:function(bu){var A=this;A.setContent(A.get(aB),bu);},syncNodeTitleUI:function(bu){var A=this;var bv=A._formatDate(A.get(bk));var bw=A._formatDate(A.get(aM));A.setTitle([bv,bw].join(v+z+v),bu);},eachRepeatedEvent:function(bu){var A=this;aF.each(A.eventStack,bu,A);},unlink:function(){var A=this;if(A.get(aH)){A.set(aH,null);}else{A.eachRepeatedEvent(function(bu,bv){bu.unlink();});}A.eventStack={};A.syncNodeUI();},_afterDisabledChange:function(bu){var A=this;A._uiSetDisabled(bu.newVal);},_afterVisibleChange:function(bu){var A=this;A._uiSetVisible(bu.newVal);},_afterRepeatChange:function(bu){var A=this;A._uiSetRepeat(bu.newVal);},_afterParentEventChange:function(bu){var A=this;A._uiSetParentEvent(bu.newVal);},_bindUIAttrs:function(){var A=this;A.after("disabledChange",A._afterDisabledChange);A.after("visibleChange",A._afterVisibleChange);A.after("parentEventChange",A._afterParentEventChange);A.after("repeatChange",A._afterRepeatChange);A._syncUIAttrs();},_propagateAttrChange:function(bw){var A=this;var bv=bw.attrName;var bu=bw.newVal;A.eachRepeatedEvent(function(bx,by){var bz=bx[aJ+a2(bv)];if(bz){bz.apply(A,[bx,bv,bu]);}else{bx.set(bv,bw.newVal);}bx.syncNodeUI();});A.syncNodeUI();},_propagateSetEndDate:function(A,bu,bw){var bv=n.clone(A.get(aM));n.copyHours(bv,bw);A.set(aM,bv);},_propagateSetStartDate:function(bu,bv,bw){var A=n.clone(bu.get(bk));n.copyHours(A,bw);bu.set(bk,A);},_setColor:function(bu){var A=this;A.hsbColor=aW.rgb2hsb(aW.getRGB(bu));
A.borderColor=aF.clone(A.hsbColor);A.borderColor.b*=A.get(aS);A.borderColor.s*=A.get(bb);A.borderColorRGB=aW.hsb2rgb(A.borderColor);return bu;},_setContent:function(bv,bx,bu){var A=this;var bw=A[bv];if(bw){bw.setContent(bx);}if(bu){A.eachRepeatedEvent(function(by,bz){by[bv].setContent(bx);});}},_setRepeat:function(bu){var A=this;if(bh(bu)){bu=aF.SchedulerEventRepeat[bu];}return P(bu)?bu:null;},_setScheduler:function(bv){var A=this;var bu=A.get(af);if(bu){A.removeTarget(bu);}A.addTarget(bv);return bv;},_syncUIAttrs:function(){var A=this;A._uiSetDisabled(A.get(B));A._uiSetVisible(A.get(an));A._uiSetParentEvent(A.get(aH));A._uiSetRepeat(A.get(aK));},_formatDate:function(bv,bw){var bu=this;var A=bu.get(bo);bw=bw||bu.get(g);return aF.DataType.Date.format(bv,{format:bw,locale:A});},_getTitleDateFormat:function(bv){var A=this;if(!bh(bv)){var bu=A.get(af);bv=(bu&&bu.get(U).get(aU))?f:a3;}return bv;},_uiSetDisabled:function(bu){var A=this;A.get(s).toggleClass(bf,!!bu);},_uiSetParentEvent:function(bu){var A=this;A.get(s).toggleClass(ax,!!bu);},_uiSetRepeat:function(bu){var A=this;A.get(s).toggleClass(al,!!bu);},_uiSetVisible:function(bu){var A=this;A.get(s).toggleClass(G,!bu);}}});aF.SchedulerEvent=V;aF.SchedulerEventRepeat={daily:{description:"Every day",validate:function(A,bu){return true;},value:"daily"},monthly:{description:"Every month",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return(A.getDate()===bv.getDate());},value:"monthly"},monWedFri:{description:"Every Monday, Wednesday and Friday",validate:function(A,bu){return n.isMonWedOrFri(bu);},value:"monWedFri"},tuesThurs:{description:"Every Tuesday and Thursday",validate:function(A,bu){return n.isTueOrThu(bu);},value:"tuesThurs"},weekDays:{description:"Every week days",validate:function(A,bu){return n.isWeekDay(bu);},value:"weekDays"},weekly:{description:"Every week",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return(A.getDay()===bv.getDay());},value:"weekly"},yearly:{description:"Every year",validate:function(bu,bv){var bw=bu.get(aM);var A=bu.get(bk);return((A.getMonth()===bv.getMonth())&&(A.getDay()===bv.getDay()));},value:"yearly"}};var U="activeView",bm="bc",bl="bd",aw="bodyContent",t="boundingBox",aG="button",e="column",aB="content",aC="dateFormat",az="dblclick",aY="desc",ay="disk",br="event",a7="field",aI="fieldset",aA="form",ah="hint",ak="input",aU="isoTime",aL="label",x="layout",aQ="menu",J="overlayContextPanel",p="pencil",aK="repeat",q="row",af="scheduler",Z="select",S="strings",a="tc",M="text",X="when",j="trigger",ai="auiSchedulerEventRecorderWhen",bc="auiSchedulerEventRecorderDesc",aX="auiSchedulerEventRecorderSelect",H="auiSchedulerEventRecorderButtonRow",ae="cancel",E="edit",aE="save",bd="-",K="#",bt=L(at,bs,k),ba=L(at,bs,aA),y=L(aA),l=L(x,aB),be=L(x,aI),ar=L(x,aI,bl),ad=L(x,aI,aB),F=L(x,"w100"),m=L(e),aO=L(e,aB),b=L(a7),C=L(a7,aQ),aP=L(a7,Z),bj=L(a7,aB),d=L(a7,aL),aV=L(a7,M),i=L(aG,q),a9=L(a7,ak),aj=L(a7,ak,Z),D=L(a7,ak,M),aT=L(at,bs,aL,X),c=L(at,bs,aY),R=L(at,bs,a7,ah),ac=L(at,bs,aK),ab=L(at,bs,aG,q),O="<option></option>",bq='<form id="auiSchedulerEventRecorderForm" class="'+[ba,l,y].join(v)+'">'+'<div class="'+[be,F,m].join(v)+'">'+'<div class="'+[ad,aO].join(v)+'aui-fieldset-content aui-column-content">'+'<div class="'+ar+'">'+'<span class="'+[b,aV].join(v)+'">'+'<span class="'+bj+'">'+'<label class="'+d+'">{when}:</label>'+'<span id="auiSchedulerEventRecorderWhen" class="'+aT+'"></span>'+"</span>"+"</span>"+'<span class="'+[b,aV].join(v)+'">'+'<span class="'+bj+'">'+'<label class="'+d+'" for="auiSchedulerEventRecorderDesc">{description}</label>'+'<input id="auiSchedulerEventRecorderDesc" class="'+[a9,D,c].join(v)+'" size="30" type="text" />'+'<div class="'+R+'">'+"<span>{description-hint}</span>"+"</div>"+"</span>"+"</span>"+'<span class="'+[b,C,aP].join(v)+'">'+'<label class="'+d+'" for="auiSchedulerEventRecorderSelect">{repeat}:</label>'+'<select id="auiSchedulerEventRecorderSelect" class="'+[a9,aj,ac].join(v)+'">'+'<option selected="selected" value="">{no-repeat}</option>'+"</select>"+"</span>"+'<div id="auiSchedulerEventRecorderButtonRow" class="'+[b,i,ab].join(v)+'"></div>'+"</div>"+"</div>"+"</div>"+"</form>";var W=aF.Component.create({NAME:au,ATTRS:{content:{value:u},duration:{value:60},dateFormat:{value:"%a, %B %d,",validator:bh},event:{},strings:{value:{},setter:function(A){return aF.merge({save:"Save",cancel:"Cancel",description:"Description",edit:"Edit",repeat:"Repeat",when:"When","description-hint":"e.g., Dinner at Brian's","no-repeat":"No repeat"},A||{});},validator:P},overlayContextPanel:{value:{},setter:function(bu){var A=this;var bv=aF.Node.create(aF.Lang.sub(bq,A.get(S)));return aF.merge({align:{points:[bm,a]},anim:false,bodyContent:bv,hideOn:az,trigger:A.get(s),visible:false,zIndex:9999},bu||{});}}},EXTENDS:aF.SchedulerEvent,prototype:{initializer:function(){var A=this;A._createEvents();A.after("schedulerChange",A._afterSchedulerChange);A.on("startDateChange",A._onStartDateChange);A.get(s).addClass(ao);},showOverlay:function(){var A=this;if(!A.overlay){A._initOverlay();}A.overlay.render().show();},getEventCopy:function(bu){var A=this;var bw=A.overlayDescNode.val();var bv=A.get(br);if(!bv){bv=new aF.SchedulerEvent({endDate:A.get(aM),scheduler:A.get(af),startDate:A.get(bk)});bv.copyPropagateAttrValues(A,{content:true});}bv.set(aK,A.overlaySelectNode.val());if(bw){bv.set(aB,bw);}return bv;},hideOverlay:function(){var A=this;if(A.overlay){A.overlay.hide();}},loadFormValues:function(){var A=this;var bw=u;var bv=u;var bu=A.get(br);if(bu){var bx=bu.get(aK);if(bx){bw=bx.value;}bv=bu.get(aB);}A.overlaySelectNode.val(bw);A.overlayWhenNode.setContent(A._getWhenFormattedDt());setTimeout(function(){A.overlayDescNode.val(bv).selectText();},0);},_afterSchedulerChange:function(bw){var A=this;var bv=bw.newVal;var bu=bv.get(t);bu.delegate("click",aF.bind(A._onClickSchedulerEvent,A),av+w);},_createEvents:function(){var A=this;var bu=function(bv,bw){A.publish(bv,{defaultFn:bw,queuable:false,emitFacade:true,bubbles:true});
};bu(aE,this._defSaveEventFn);bu(E,this._defEditEventFn);bu(ae,this._defCancelEventFn);},_initOverlay:function(){var bu=this;var A=bu.get(S);bu.overlay=new aF.OverlayContextPanel(bu.get(J));var bw=bu.overlay;var bv=bw.get(t);var bx=bw.get(aw);bu.overlayButtonRowNode=bx.one(K+H);bu.overlayDescNode=bx.one(K+bc);bu.overlaySelectNode=bx.one(K+aX);bu.overlayWhenNode=bx.one(K+ai);bu.overlaySaveBtn=new aF.ButtonItem({label:A.save,icon:ay,render:bu.overlayButtonRowNode,handler:{fn:bu._handleSaveEvent,context:bu}});bu.overlayEditBtn=new aF.ButtonItem({label:A.edit,icon:p,render:bu.overlayButtonRowNode,handler:{fn:bu._handleEditEvent,context:bu}});bu.overlayCancelBtn=new aF.ButtonItem({label:A.cancel,render:bu.overlayButtonRowNode,handler:{fn:bu._handleCancelEvent,context:bu}});aF.each(aF.SchedulerEventRepeat,function(bz,by){bu.overlaySelectNode.append(aF.Node.create(O).val(bz.value||by).setContent(bz.description));});bw.on("hide",aF.bind(bu._onOverlayHide,bu));bw.on("show",aF.bind(bu._onOverlayShow,bu));bx.on("submit",aF.bind(bu._onSubmitForm,bu));bv.addClass(bt);},_defCancelEventFn:function(bu){var A=this;A.hideOverlay();},_defEditEventFn:function(bv){var A=this;var bu=A.get(af);A.hideOverlay();bu.syncEventsUI();},_defSaveEventFn:function(bv){var A=this;var bu=A.get(af);bu.addEvent(bv.newSchedulerEvent);A.hideOverlay();bu.syncEventsUI();},_getWhenFormattedDt:function(){var bv=this;var bu=bv.get(aC);var bx=(bv.get(br)||bv);var bz=bx.get(aM);var by=bx.get(af);var A=bx.get(bk);var bw=(by.get(U).get(aU)?n.toIsoTimeString:n.toUsTimeString);return[bx._formatDate(A,bu),bw(A),bd,bw(bz)].join(v);},_handleEditEvent:function(bu){var A=this;A.fire(E,{newSchedulerEvent:A.getEventCopy()});bu.preventDefault();},_handleSaveEvent:function(bu){var A=this;A.fire(aE,{newSchedulerEvent:A.getEventCopy()});bu.preventDefault();},_handleCancelEvent:function(bu){var A=this;A.fire(ae);bu.preventDefault();},_onClickSchedulerEvent:function(bv){var A=this;var bu=bv.currentTarget.getData(at);if(bu){if(!A.overlay){A._initOverlay();}A.set(br,bu);A.overlay.set(j,bu.get(s));A.get(s).remove();A.showOverlay();}},_onOverlayHide:function(bv){var A=this;var bu=A.get(s);if(A.overlay){A.set(br,null);A.overlay.set(j,bu);}bu.remove();},_onOverlayShow:function(bv){var bu=this;var bw=bu.overlayEditBtn;var A=bu.overlaySaveBtn;if(bu.get(br)){bw.show();A.hide();}else{bw.hide();A.show();}bu.loadFormValues();},_onStartDateChange:function(bu){var A=this;var bv=A.get(aZ);A.set(aM,n.add(bu.newVal,n.MINUTES,bv));},_onSubmitForm:function(bu){var A=this;if(A.get(br)){A._handleEditEvent(bu);}else{A._handleSaveEvent(bu);}}}});aF.SchedulerEventRecorder=W;},"@VERSION@",{skinnable:true,requires:["aui-base","aui-color-util","aui-datatype","aui-overlay-context-panel"]});AUI.add("aui-scheduler-calendar",function(d){var i=d.Lang,j=i.isArray,c=i.isBoolean,b=i.isString,g=function(m){return(m instanceof d.SchedulerEvent);},e="scheduler-calendar",a="color",l="events",h="pallete",k="visible";var f=d.Component.create({NAME:e,ATTRS:{color:{valueFn:function(){var n=this;var o=n.get(h);var m=Math.ceil(Math.random()*o.length)-1;return o[m];},validator:b},name:{value:"(no name)",validator:b},pallete:{value:["#d96666","#e67399","#b373b3","#8c66d9","#668cb3","#668cd9","#59bfb3","#65ad89","#4cb052","#8cbf40","#bfbf4d","#e0c240","#f2a640","#e6804d","#be9494","#a992a9","#8997a5","#94a2be","#85aaa5","#a7a77d","#c4a883","#c7561e","#b5515d","#c244ab","#603f99","#536ca6","#3640ad","#3c995b","#5ca632","#7ec225","#a7b828","#cf9911","#d47f1e","#b56414","#914d14","#ab2671","#9643a5","#4585a3","#737373","#41a587","#d1bc36","#ad2d2d"],validator:j},visible:{value:true,validator:c}},EXTENDS:d.Base,AUGMENTS:d.SchedulerEventSupport,prototype:{initializer:function(){var m=this;m.after("eventsChange",m._afterEventsChange);m.on("visibleChange",m._onVisibleChange);m._uiSetVisible(m.get(k));m._uiSetEvents(m.get(l));},syncEventsColor:function(n){var m=this;d.Array.each(n||m.get(l),function(o,p){o.set(a,m.get(a));});},_afterEventsChange:function(n){var m=this;m._uiSetEvents(n.newVal);},_onVisibleChange:function(n){var m=this;m._uiSetVisible(n.newVal);},_uiSetEvents:function(n){var m=this;m.syncEventsColor(n);},_uiSetVisible:function(n){var m=this;m.eachEvent(function(o,p){o.set(k,n);});}}});d.SchedulerCalendar=f;},"@VERSION@",{requires:["aui-scheduler-event"],skinnable:true});AUI.add("aui-scheduler",function(a){},"@VERSION@",{use:["aui-scheduler-base","aui-scheduler-view","aui-scheduler-event","aui-scheduler-calendar"],skinnable:true});